(function(){"use strict";var e={9267:function(e,t,s){var n=s(5130),a=s(6768),i=s(4232);const o={style:{"z-index":"100",position:"fixed",top:"55px",width:"100%"}},l={key:0},r={class:"left"},c={class:"right"},d={key:0,class:"additional_settings",ref:"additional_settings"},u={class:"holder1"},p={style:{margin:"0","margin-left":"5px","margin-right":"5px"}},h={style:{margin:"0","margin-left":"5px","margin-right":"5px"}};function g(e,t,s,g,m,y){const f=(0,a.g2)("NotificationPopup"),k=(0,a.g2)("HorizontalLoader"),_=(0,a.g2)("router-link"),b=(0,a.g2)("router-view"),v=(0,a.g2)("ApiConnect"),L=(0,a.g2)("LoadingIcon");return(0,a.uX)(),(0,a.CE)(a.FK,null,[(0,a.bF)(f),(0,a.bo)((0,a.Lk)("div",o,[(0,a.bF)(k)],512),[[n.aG,this.isLoading]]),e.$route.meta.hideNavbar?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.CE)("nav",l,[(0,a.Lk)("div",r,[(0,a.bF)(_,{to:"/"},{default:(0,a.k6)(()=>[...t[1]||(t[1]=[(0,a.eW)("ê„— CRTMGR",-1)])]),_:1}),(0,a.bF)(_,{to:"/tree"},{default:(0,a.k6)(()=>[...t[2]||(t[2]=[(0,a.eW)("CERT RELATIONS",-1)])]),_:1})]),(0,a.Lk)("div",c,[(0,a.Lk)("a",{ref:"additional_settings_btn",onClick:t[0]||(t[0]=(...e)=>y.toggleOpen&&y.toggleOpen(...e)),to:"#"}," â˜° ",512)]),(0,a.bF)(n.eB,{name:"dropdown"},{default:(0,a.k6)(()=>[m.open?((0,a.uX)(),(0,a.CE)("div",d,[(0,a.Lk)("div",u,[(0,a.Lk)("p",p,(0,i.v_)(m.current_time),1),(0,a.Lk)("p",h,"Hello, "+(0,i.v_)(m.username),1),t[6]||(t[6]=(0,a.Lk)("br",null,null,-1)),(0,a.bF)(_,{style:{display:"block","text-align":"left",background:"linear-gradient(to bottom right,\n              rgba(255, 255, 255, 0.6),\n              rgba(255, 255, 255, 0) 70%)","margin-bottom":"5px"},to:"/settings"},{default:(0,a.k6)(()=>[...t[3]||(t[3]=[(0,a.Lk)("img",{class:"icon",src:"/icons/gear.png"},null,-1),(0,a.eW)("Â SETTINGS ",-1)])]),_:1}),(0,a.bF)(_,{style:{display:"block","text-align":"left",background:"linear-gradient(to bottom right,\n              rgba(255, 255, 255, 0.6),\n              rgba(255, 255, 255, 0) 70%)","margin-bottom":"5px"},to:"/apidocs"},{default:(0,a.k6)(()=>[...t[4]||(t[4]=[(0,a.Lk)("img",{class:"icon",src:"/icons/attachment.png"},null,-1),(0,a.eW)("Â API DOCS ",-1)])]),_:1}),(0,a.bF)(_,{style:{display:"block","text-align":"left",background:"linear-gradient(to bottom right,\n              rgba(255, 255, 255, 0.6),\n              rgba(255, 255, 255, 0) 70%)"},to:"/login"},{default:(0,a.k6)(()=>[...t[5]||(t[5]=[(0,a.Lk)("img",{class:"icon",src:"/icons/motion_blur.png"},null,-1),(0,a.eW)("Â LOGOUT ",-1)])]),_:1})])],512)):(0,a.Q3)("",!0)]),_:1})])),(0,a.bF)(n.eB,{name:"page",mode:"out-in"},{default:(0,a.k6)(()=>[(0,a.bF)(b)]),_:1}),(0,a.bF)(v,{ref:"ApiConnect"},null,512),(0,a.Lk)("div",{class:(0,i.C4)({hidden:!m.isLoading}),id:"follower"},[(0,a.bF)(L,{style:{height:"20px",width:"20px"}})],2)],64)}function m(e,t,s,n,i,o){return(0,a.uX)(),(0,a.CE)("div")}s(4114),s(8111),s(7588),s(1701),s(4979),s(4603),s(7566),s(8721);var y=s(4373),f=s(595);const k=(0,f.A)();var _=k,b={name:"ApiConnect",components:{},data(){return{username:"",password:""}},methods:{resolve_api_url(){const e="/api";return e},get_current_bearer(){var e=localStorage.getItem("crtmgr-jwt");return e},process_err_warning(e){console.log("errors warnings",e),void 0!=e&&("warnings"in e&&e.warnings.forEach(e=>{_.emit("notificationContent",{type:"warning",content:`API warning: ${e}`})}),"errors"in e&&e.errors.forEach(e=>{_.emit("notificationContent",{type:"error",content:`API error: ${e}`})}))},set_jwt_in_resp(e){"token"in e&&localStorage.setItem("crtmgr-jwt",e["token"])},parse_jwt(e){var t=e.split(".")[1],s=t.replace(/-/g,"+").replace(/_/g,"/"),n=decodeURIComponent(window.atob(s).split("").map(function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)}).join(""));return JSON.parse(n)},get_jwt(){var e=localStorage.getItem("crtmgr-jwt");try{var t=this.parse_jwt(e);return t}catch{return null}},async send_post(e,t,s,n=!0){_.emit("loadingContent",!0);const a=`${this.resolve_api_url()}${e}`;var i={"Content-Type":"application/json"};void 0!=this.get_current_bearer()&&(i["Authorization"]=`Bearer ${this.get_current_bearer()}`),void 0!=s&&(i={...i,...s});try{const e=await y.A.post(a,t,{headers:i});return this.set_jwt_in_resp(e.data),this.process_err_warning(e.data),_.emit("loadingContent",!1),e.data}catch(o){_.emit("loadingContent",!1);try{this.process_err_warning(o.response.data)}catch{console.log("API error:",o),console.log(o.status)}if(console.log("API error:",o),403!=o.status&&_.emit("notificationContent",{type:"error",content:`API error calling: ${o}`}),403==o.status)return!0===n&&this.$router.push("/login"),o.response.data}},async send_get(e,t,s=!0,n=!0){_.emit("loadingContent",!0);const a=`${this.resolve_api_url()}${e}`;var i={"Content-Type":"application/json"};void 0!=this.get_current_bearer()&&(i["Authorization"]=`Bearer ${this.get_current_bearer()}`),void 0!=t&&(i={...i,...t}),console.log(n);try{const e=await y.A.get(a,{headers:i,responseType:n?"json":"blob"});return n?(this.set_jwt_in_resp(e.data),console.log(e.data),this.process_err_warning(e.data),_.emit("loadingContent",!1),e.data):e.data}catch(o){_.emit("loadingContent",!1);try{this.process_err_warning(o.response.data)}catch{console.log("API error:",o),console.log(o.status)}if(console.log("API error:",o),403!=o.status&&_.emit("notificationContent",{type:"error",content:`API error calling: ${o}`}),this.process_err_warning(o),console.log(o.status),403==o.status)return!0===s&&this.$router.push("/login"),o.response.data}},download_authority_buffered:async function(e){var t=`/download/certauthority/${e}/?buffer=true`;const s=await this.send_get(t,{},!0,!1),n=e+".pem";console.log(s);const a=new Blob([s],{type:"text/plain"}),i=URL.createObjectURL(a),o=document.createElement("a");o.href=i,o.download=n,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(i)},download_certificate_buffered:async function(e,t){var s=`/download/certificate/${e}/${t}/?buffer=true`;const n=await this.send_get(s,{},!0,!1),a=`${e}_${t}".zip`;console.log(n);const i=new Blob([n],{type:"text/plain"}),o=URL.createObjectURL(i),l=document.createElement("a");l.href=o,l.download=a,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(o)}}},v=s(1241);const L=(0,v.A)(b,[["render",m]]);var w=L;const C={class:"progress-wrap",role:"progressbar"};function x(e,t,s,n,i,o){return(0,a.uX)(),(0,a.CE)("div",C,[...t[0]||(t[0]=[(0,a.Lk)("div",{class:"progress"},[(0,a.Lk)("div",{class:"shine"})],-1)])])}var A={name:"HorizontalLoader",components:{},data(){return{}},methods:{}};const S=(0,v.A)(A,[["render",x],["__scopeId","data-v-555f24a2"]]);var M=S;const D={class:"vista-loader"};function E(e,t,s,n,i,o){return(0,a.uX)(),(0,a.CE)("div",D)}var I={name:"CertificateSubj",components:{},data(){return{}},methods:{}};const P=(0,v.A)(I,[["render",E],["__scopeId","data-v-6f9c7272"]]);var j=P;const U={class:"notification-container"},$={style:{"text-wrap":"auto","text-align":"right","font-family":"system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif","font-size":"0.8em",margin:"0px","margin-top":"10px"}},F={key:0},N={class:"createfirst",style:{},id:"createCert"},V={class:"holder",style:{margin:"10px",height:"calc(100% - 40px)"}},T={style:{display:"flex","justify-content":"center","margin-top":"20px"}};function W(e,t,s,n,o,l){return(0,a.uX)(),(0,a.CE)(a.FK,null,[(0,a.Lk)("div",U,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(o.notifications,(e,t)=>((0,a.uX)(),(0,a.CE)("div",{key:t,class:"holder"},[(0,a.Lk)("div",{class:(0,i.C4)(["notification",e.type])},[(0,a.Lk)("pre",$,"      "+(0,i.v_)(e.message)+"\n    ",1)],2)]))),128))]),o.showGettingStarted?((0,a.uX)(),(0,a.CE)("div",F,[(0,a.Lk)("div",N,[(0,a.Lk)("div",V,[t[1]||(t[1]=(0,a.Lk)("p",{class:"createfirst",style:{"font-size":"1.2em","font-weight":"300","text-transform":"uppercase","margin-top":"5px","margin-bottom":"5px"}}," ðŸ‘‹ Get started ",-1)),t[2]||(t[2]=(0,a.Lk)("p",{class:"createfirst",style:{"margin-top":"5px"}},"You don't have any certificate authorities yet. Click below to get started",-1)),t[3]||(t[3]=(0,a.Lk)("hr",null,null,-1)),(0,a.Lk)("div",T,[(0,a.Lk)("button",{class:"glass-button",style:{width:"200px",height:"2.5em","margin-bottom":"20px"},onClick:t[0]||(t[0]=t=>{o.showGettingStarted=!1,e.$router.push({path:"/createcert",query:{show:"ca"}})})}," Set one up âžœ ")])])])])):(0,a.Q3)("",!0)],64)}s(2489);let O=1;var q={name:"NotificationPopup",data(){return{notifications:[],showGettingStarted:!1}},methods:{addNotification(e,t){"success"==e&&(t=`âœ… ${t}`),"error"==e&&(t=`â›” ${t}`),"warning"==e&&(t=`âš ï¸ ${t}`);const s={id:O++,type:e,message:t};this.notifications.push(s);const n="error"===e?1e4:5e3;setTimeout(()=>{this.notifications=this.notifications.filter(e=>e.id!==s.id)},n)}},async mounted(){_.on("notificationContent",e=>{let t=e.type,s=e.content;this.addNotification(t,s)}),_.on("notificationGetStarted",e=>{console.log(e),this.showGettingStarted=!0,setTimeout(()=>{this.showGettingStarted=!1},9e3)})}};const K=(0,v.A)(q,[["render",W],["__scopeId","data-v-74e48b34"]]);var X=K,z={name:"App",components:{LoadingIcon:j,ApiConnect:w,HorizontalLoader:M,NotificationPopup:X},data(){return{current_time:(new Date).toLocaleTimeString(),isLoading:!1,username:"somebody",open:!1}},methods:{toggleOpen:function(){this.open=!this.open},initMouseFollower:function(){const e=document.getElementById("follower");document.addEventListener("mousemove",t=>{e.style.left=t.pageX+10+"px",e.style.top=t.pageY+10+"px"})},handleClickOutside:function(e){const t=this.$refs.additional_settings,s=this.$refs.additional_settings_btn;t&&!t.contains(e.target)&&s&&!s.contains(e.target)&&(console.log("click outside"),this.open=!1)}},async mounted(){document.addEventListener("click",this.handleClickOutside),this.initMouseFollower(),this.username=this.$refs.ApiConnect.get_jwt()["sub"],this.current_time=setInterval(()=>{this.current_time=(new Date).toLocaleTimeString()},1e3),_.on("loadingContent",e=>{this.isLoading=e})},beforeUnmount(){clearInterval(this.timer),document.removeEventListener("click",this.handleClickOutside)}};const R=(0,v.A)(z,[["render",g]]);var B=R,G=s(1387);const J={class:"login-container"},Q={class:"pictureframe"},H={key:0,style:{"margin-left":"auto","margin-right":"auto","text-align":"center",width:"75px"},src:"/icons/icon.png"},Y=["onclick"],Z={style:{color:"whitesmoke"}};function ee(e,t,s,o,l,r){const c=(0,a.g2)("LoadingIcon"),d=(0,a.g2)("ApiConnect");return(0,a.uX)(),(0,a.CE)(a.FK,null,[(0,a.Lk)("div",J,[(0,a.Lk)("div",Q,[this.isLoading?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.CE)("img",H)),this.isLoading?((0,a.uX)(),(0,a.Wv)(c,{key:1,style:{"margin-left":"auto","margin-right":"auto","text-align":"center","margin-top":"25px"}})):(0,a.Q3)("",!0)]),t[3]||(t[3]=(0,a.Lk)("h1",{style:{"font-weight":"100"}},"ê„— CRTMGR",-1)),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>this.username=e),type:"text",id:"username",name:"username",placeholder:"USERNAME"},null,512),[[n.Jo,this.username]]),t[4]||(t[4]=(0,a.Lk)("br",null,null,-1)),t[5]||(t[5]=(0,a.Lk)("br",null,null,-1)),(0,a.bo)((0,a.Lk)("input",{onKeyup:t[1]||(t[1]=(0,n.jR)((...e)=>r.do_login&&r.do_login(...e),["enter"])),"onUpdate:modelValue":t[2]||(t[2]=e=>this.password=e),type:"password",id:"password",name:"password",placeholder:"PASSWORD",required:""},null,544),[[n.Jo,this.password]]),t[6]||(t[6]=(0,a.Lk)("br",null,null,-1)),t[7]||(t[7]=(0,a.Lk)("br",null,null,-1)),(0,a.Lk)("button",{class:"glass-button",onclick:r.do_login},"Login ",8,Y),(0,a.bo)((0,a.Lk)("p",{style:{color:"red"}},(0,i.v_)(this.err),513),[[n.aG,this.err]]),(0,a.bo)((0,a.Lk)("p",Z,"Login to continue",512),[[n.aG,!this.err]])]),(0,a.bF)(d,{ref:"ApiConnect"},null,512)],64)}var te={name:"LogonWindow",components:{ApiConnect:w,LoadingIcon:j},data(){return{username:"",password:"",err:"",isLoading:!1}},methods:{async do_login(){localStorage.removeItem("crtmgr-jwt");const e={username:this.username,password:this.password};var t=await this.$refs.ApiConnect.send_post("/user/login/",e);console.log(t),t.errors.length>0&&(this.err=t.errors.join("<br>")),void 0!=t.token&&t.token.length>0&&this.$router.push("/")}},mounted(){_.on("loadingContent",e=>{this.isLoading=e})}};const se=(0,v.A)(te,[["render",ee],["__scopeId","data-v-04724bc2"]]);var ne=se;const ae={style:{width:"88vw","margin-left":"auto","margin-right":"auto"}},ie={class:"table_container"},oe={class:"table_container",style:{margin:"10px",width:"calc(100% - 20px)"}},le={cellpadding:"8",cellspacing:"0",class:"table_container"},re={style:{"font-weight":"500"}},ce=["onClick"],de=["onClick"],ue=["onClick"],pe={id:"viewCaModal",class:"homeModal"},he={class:"holder"},ge={style:{"text-wrap":"initial","white-space":"pre-line","font-size":"0.7em"}},me={class:"table_container"},ye={class:"table_container",style:{margin:"10px",width:"calc(100% - 20px)"}},fe={cellpadding:"8",cellspacing:"0"},ke={style:{"font-weight":"500"}},_e={style:{"font-weight":"500"}},be={style:{"min-width":"10vw"}},ve=["onClick"],Le=["onClick"],we=["onClick"],Ce={id:"viewcertModal",class:"homeModal"},xe={class:"holder"},Ae={style:{"text-wrap":"initial","white-space":"pre-line","font-size":"0.8em","text-align":"left"}},Se={style:{"text-wrap":"initial","white-space":"pre-line","font-size":"0.8em","text-align":"left"}},Me={id:"deleteModal",class:"homeModal"},De={class:"holder"},Ee={key:0,style:{margin:"10px",color:"darkred"}},Ie={key:1,style:{margin:"10px",color:"darkred","padding-bottom":"20px"}},Pe={style:{margin:"10px",color:"green"}},je={style:{"text-align":"center","margin-left":"auto","margin-right":"auto","padding-bottom":"10px"}};function Ue(e,t,s,o,l,r){const c=(0,a.g2)("ApiConnect"),d=(0,a.g2)("DropDown");return(0,a.uX)(),(0,a.CE)(a.FK,null,[(0,a.bF)(c,{ref:"ApiConnect"},null,512),(0,a.Lk)("div",ae,[t[43]||(t[43]=(0,a.Lk)("br",null,null,-1)),t[44]||(t[44]=(0,a.Lk)("br",null,null,-1)),t[45]||(t[45]=(0,a.Lk)("h2",{style:{"text-align":"left"}},"Manage Certificate Authorities",-1)),(0,a.Lk)("div",ie,[(0,a.Lk)("button",{onClick:t[0]||(t[0]=t=>e.$router.push({path:"/createcert",query:{show:"ca"}})),class:"glass-button",style:{"margin-top":"5px","margin-left":"12px",float:"left"}},[...t[14]||(t[14]=[(0,a.Lk)("img",{class:"icon",src:"/icons/add.png"},null,-1),(0,a.eW)("Â New",-1)])]),(0,a.bF)(d,{style:{"margin-top":"5px","margin-left":"5px",float:"left"},placeholder:"Sort by",options:this.certificateSortOpts,modelValue:this.caFilterBy,"onUpdate:modelValue":t[1]||(t[1]=e=>this.caFilterBy=e),onUpdateFilter:t[2]||(t[2]=e=>r.sortCertificates("ca"))},null,8,["options","modelValue"]),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[3]||(t[3]=e=>this.caSearchterm=e),style:{float:"left","margin-top":"5px","margin-left":"5px"},type:"text",id:"filter_ca",name:"filter_ca",placeholder:"Search",onKeyup:t[4]||(t[4]=e=>this.applySearch("ca"))},null,544),[[n.Jo,this.caSearchterm]]),t[20]||(t[20]=(0,a.Lk)("br",null,null,-1)),t[21]||(t[21]=(0,a.Lk)("br",null,null,-1)),(0,a.Lk)("div",oe,[(0,a.Lk)("table",le,[t[18]||(t[18]=(0,a.Lk)("thead",null,[(0,a.Lk)("tr",null,[(0,a.Lk)("th",null,"Common Name"),(0,a.Lk)("th",null,"Name"),(0,a.Lk)("th",null,"Created"),(0,a.Lk)("th",null,"Status"),(0,a.Lk)("th",null,"Remaining Days"),(0,a.Lk)("th",null,"Days Lifetime"),(0,a.Lk)("th",{style:{"min-width":"15vw"}},"Action")])],-1)),(0,a.Lk)("tbody",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(this.authorities_show,s=>((0,a.uX)(),(0,a.CE)("tr",{key:s.sys_id},[(0,a.Lk)("td",re,(0,i.v_)(s.common_name),1),(0,a.Lk)("td",null,(0,i.v_)(s.name),1),(0,a.Lk)("td",null,(0,i.v_)(r.unix_to_ts(s.created)),1),(0,a.Lk)("td",{class:(0,i.C4)(s.status)},(0,i.v_)(s.status),3),(0,a.Lk)("td",null,(0,i.v_)(s.remaining_days),1),(0,a.Lk)("td",null,(0,i.v_)(s.days),1),(0,a.Lk)("td",null,[(0,a.Lk)("button",{class:"glass-button",onClick:e=>r.showDeleteModal("ca",s.sys_id),style:{"margin-right":"5px",padding:"5px"}},[...t[15]||(t[15]=[(0,a.Lk)("img",{class:"icon",src:"/icons/delete.png"},null,-1)])],8,ce),(0,a.Lk)("button",{class:"glass-button",onClick:t=>e.$refs.ApiConnect.download_authority_buffered(s.sys_id),style:{"margin-right":"5px",padding:"5px"}},[...t[16]||(t[16]=[(0,a.Lk)("img",{class:"icon",src:"/icons/diskette.png"},null,-1)])],8,de),(0,a.Lk)("button",{class:"glass-button",style:{padding:"5px"},onClick:e=>r.showCaModal(s.sys_id)},[...t[17]||(t[17]=[(0,a.Lk)("img",{class:"icon",src:"/icons/zoom.png"},null,-1)])],8,ue)])]))),128))])])]),(0,a.Lk)("dialog",pe,[(0,a.Lk)("button",{autofocus:"",class:"close-btn",onClick:t[5]||(t[5]=(...e)=>r.hideCaModel&&r.hideCaModel(...e))},"x"),t[19]||(t[19]=(0,a.Lk)("h2",{class:"modalhead"},"Certificate data",-1)),(0,a.Lk)("div",he,[(0,a.Lk)("pre",ge," "+(0,i.v_)(this.caModal_cert)+" ",1)])])]),t[46]||(t[46]=(0,a.Lk)("br",null,null,-1)),t[47]||(t[47]=(0,a.Lk)("br",null,null,-1)),t[48]||(t[48]=(0,a.Lk)("h2",{style:{"text-align":"left"}},"Manage Certificates",-1)),(0,a.Lk)("div",me,[(0,a.Lk)("button",{onClick:t[6]||(t[6]=t=>e.$router.push({path:"/createcert",query:{show:"cert"}})),class:"glass-button",style:{"margin-top":"5px","margin-left":"12px",float:"left"}},[...t[22]||(t[22]=[(0,a.Lk)("img",{class:"icon",src:"/icons/add.png"},null,-1),(0,a.eW)("Â New",-1)])]),(0,a.bF)(d,{style:{"margin-top":"5px","margin-left":"5px",float:"left"},placeholder:"Sort by",options:this.certificateSortOpts,modelValue:this.certFilterBy,"onUpdate:modelValue":t[7]||(t[7]=e=>this.certFilterBy=e),onUpdateFilter:t[8]||(t[8]=e=>r.sortCertificates("cert"))},null,8,["options","modelValue"]),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[9]||(t[9]=e=>this.certSearchterm=e),style:{float:"left","margin-top":"5px","margin-left":"5px"},type:"text",id:"filter_cert",name:"filter_cert",placeholder:"Search",onKeyup:t[10]||(t[10]=e=>r.applySearch("cert"))},null,544),[[n.Jo,this.certSearchterm]]),t[27]||(t[27]=(0,a.Lk)("br",null,null,-1)),t[28]||(t[28]=(0,a.Lk)("br",null,null,-1)),(0,a.Lk)("div",ye,[(0,a.Lk)("table",fe,[t[26]||(t[26]=(0,a.Lk)("thead",null,[(0,a.Lk)("tr",null,[(0,a.Lk)("th",null,"Common Name"),(0,a.Lk)("th",null,"CA Common Name"),(0,a.Lk)("th",null,"Name"),(0,a.Lk)("th",null,"Created"),(0,a.Lk)("th",null,"Status"),(0,a.Lk)("th",null,"Remaining Days"),(0,a.Lk)("th",null,"Days Lifetime"),(0,a.Lk)("th",{style:{"min-width":"15vw"}},"Action")])],-1)),(0,a.Lk)("tbody",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(this.certificates_show,s=>((0,a.uX)(),(0,a.CE)("tr",{key:s.id},[(0,a.Lk)("td",ke,(0,i.v_)(s.common_name),1),(0,a.Lk)("td",_e,(0,i.v_)(s.ca_common_name),1),(0,a.Lk)("td",null,(0,i.v_)(s.name),1),(0,a.Lk)("td",null,(0,i.v_)(r.unix_to_ts(s.created)),1),(0,a.Lk)("td",{class:(0,i.C4)(s.status)},(0,i.v_)(s.status),3),(0,a.Lk)("td",null,(0,i.v_)(s.remaining_days),1),(0,a.Lk)("td",null,(0,i.v_)(s.days),1),(0,a.Lk)("td",be,[(0,a.Lk)("button",{class:"glass-button",onClick:e=>r.showDeleteModal("cert",s.parent_ca_sys_id,s.name),style:{"margin-right":"5px",padding:"5px"}},[...t[23]||(t[23]=[(0,a.Lk)("img",{class:"icon",src:"/icons/delete.png"},null,-1)])],8,ve),(0,a.Lk)("button",{class:"glass-button",onClick:t=>e.$refs.ApiConnect.download_certificate_buffered(s.parent_ca_sys_id,s.name),style:{"margin-right":"5px",padding:"5px"}},[...t[24]||(t[24]=[(0,a.Lk)("img",{class:"icon",src:"/icons/diskette.png"},null,-1)])],8,Le),(0,a.Lk)("button",{class:"glass-button",style:{padding:"5px"},onClick:e=>r.showCertModal(s.parent_ca_sys_id,s.name)},[...t[25]||(t[25]=[(0,a.Lk)("img",{class:"icon",src:"/icons/zoom.png"},null,-1)])],8,we)])]))),128))])])])]),(0,a.Lk)("dialog",Ce,[(0,a.Lk)("button",{autofocus:"",class:"close-btn",onClick:t[11]||(t[11]=(...e)=>r.hideCertModal&&r.hideCertModal(...e))},"x"),t[32]||(t[32]=(0,a.Lk)("h2",{class:"modalhead"},"Certificate and key data",-1)),(0,a.Lk)("div",xe,[t[29]||(t[29]=(0,a.Lk)("h2",null,"Certificate data",-1)),(0,a.Lk)("pre",Ae," "+(0,i.v_)(this.crtModal_cert)+" ",1),t[30]||(t[30]=(0,a.Lk)("br",null,null,-1)),t[31]||(t[31]=(0,a.Lk)("h2",null,"Key data",-1)),(0,a.Lk)("pre",Se," "+(0,i.v_)(this.crtModal_key)+" ",1)])]),(0,a.Lk)("dialog",Me,[(0,a.Lk)("button",{autofocus:"",class:"close-btn",onClick:t[12]||(t[12]=e=>r.hideModal("deleteModal"))},"x"),t[42]||(t[42]=(0,a.Lk)("h2",{class:"modalhead"},"Confirmation!",-1)),(0,a.Lk)("div",De,["ca"==this.deleteModaltype?((0,a.uX)(),(0,a.CE)("p",Ee,[t[33]||(t[33]=(0,a.eW)("This will delete this authority. This will also delete ",-1)),(0,a.Lk)("b",null,(0,i.v_)(this.caDeleteModelCount),1),t[34]||(t[34]=(0,a.eW)(" underlying certificates associated with the authority. ",-1)),t[35]||(t[35]=(0,a.Lk)("br",null,null,-1)),t[36]||(t[36]=(0,a.Lk)("br",null,null,-1)),t[37]||(t[37]=(0,a.Lk)("i",null," (This action does not revoke the authority itself and will be trusted for as long as the certificate is valid)",-1)),t[38]||(t[38]=(0,a.eW)()),t[39]||(t[39]=(0,a.Lk)("br",null,null,-1)),t[40]||(t[40]=(0,a.Lk)("br",null,null,-1))])):(0,a.Q3)("",!0),"cert"==this.deleteModaltype?((0,a.uX)(),(0,a.CE)("p",Ie,"This will delete this certificate from the store. Only delete this if you have a copy or it is no longer needed.")):(0,a.Q3)("",!0),(0,a.Lk)("p",Pe,(0,i.v_)(this.deleteShowMessage),1),(0,a.Lk)("div",je,[this.showDeleteContinue?((0,a.uX)(),(0,a.CE)("button",{key:0,style:{"margin-left":"auto","margin-right":"auto"},class:"glass-button",autofocus:"",onClick:t[13]||(t[13]=(...e)=>r.deleteModalContinue&&r.deleteModalContinue(...e))},[...t[41]||(t[41]=[(0,a.Lk)("img",{class:"icon",src:"/icons/trash_full.png",alt:""},null,-1),(0,a.eW)(" Delete Anyway",-1)])])):(0,a.Q3)("",!0)])])])])],64)}const $e={ref:"dropdownRef",class:"dropdown-container"},Fe={key:0,class:"dropdown-list"},Ne={style:{width:"calc(100% - 20px)"},class:"holder"},Ve=["onClick"];function Te(e,t,s,n,o,l){return(0,a.uX)(),(0,a.CE)("div",$e,[(0,a.Lk)("button",{style:{},class:"dropdown-button",onClick:t[0]||(t[0]=(...e)=>n.toggleDropdown&&n.toggleDropdown(...e))},[(0,a.eW)((0,i.v_)(n.selected||s.placeholder)+" ",1),t[1]||(t[1]=(0,a.Lk)("span",{class:"arrow"},"â–¾",-1))]),n.open?((0,a.uX)(),(0,a.CE)("div",Fe,[(0,a.Lk)("div",Ne,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(s.options,e=>((0,a.uX)(),(0,a.CE)("button",{key:e.emitValue,class:"dropdown-item",onClick:t=>n.selectOption(e)},(0,i.v_)(e.displayName),9,Ve))),128))])])):(0,a.Q3)("",!0)],512)}var We=s(144),Oe={name:"DropDown",props:{options:{type:Array,required:!0},placeholder:{type:String,default:"Select an option"}},emits:["update:modelValue","updateFilter"],setup(e,{emit:t}){const s=(0,We.KR)(!1),n=(0,We.KR)(""),i=(0,We.KR)(null),o=()=>{s.value=!s.value},l=e=>{n.value=e.displayName,t("update:modelValue",e.emitValue),t("updateFilter",e.emitValue),s.value=!1},r=e=>{i.value&&!i.value.contains(e.target)&&(s.value=!1)};return(0,a.sV)(()=>{document.addEventListener("click",r)}),(0,a.xo)(()=>{document.removeEventListener("click",r)}),{open:s,selected:n,dropdownRef:i,toggleDropdown:o,selectOption:l}}};const qe=(0,v.A)(Oe,[["render",Te],["__scopeId","data-v-42cf506f"]]);var Ke=qe,Xe={name:"HelloWorld",components:{ApiConnect:w,DropDown:Ke},props:{msg:String},data(){return{authorities_show:[],authorities:[],certificates:[],certificates_show:[],certificateSortOpts:[{displayName:"Expiring Soon",emitValue:"expiring-soonest"},{displayName:"Name (A-Z)",emitValue:"name-asc"},{displayName:"Name (Z-A)",emitValue:"name-desc"},{displayName:"Newest Created First",emitValue:"newest-oldest"},{displayName:"Oldest Created First",emitValue:"oldest-newest"}],caModal_cert:"",crtModal_cert:"",crtModal_key:"",deleteModaltype:"",caDeleteModelCount:-1,caDeleteModalSysid:"",deleteModalCertName:"",deleteShowMessage:"",showDeleteContinue:!1,caSearchterm:"",certSearchterm:"",caFilterBy:"",certFilterBy:""}},methods:{unix_to_ts(e){const t=new Date(1e3*e);return t.toLocaleString()},async get_authorities(){var e=await this.$refs.ApiConnect.send_get("/list/certauthority/",{},!0);void 0!=e&&"result"in e&&(this.authorities=e.result,this.authorities_show=e.result,0==this.authorities.length&&_.emit("notificationGetStarted",!0))},async get_certificates(){var e=await this.$refs.ApiConnect.send_get("/list/certificates/",{},!0);void 0!=e&&"result"in e&&(this.certificates=e.result,this.certificates_show=e.result)},showCaModal:async function(e){console.log(e),this.caModal_cert="";var t=await this.$refs.ApiConnect.send_get("/download/certauthority/"+e+"/",{},!0);this.caModal_cert=t.result.cert;var s=document.getElementById("viewCaModal");s.showModal()},showDeleteModal:async function(e,t,s){console.log(s),this.showDeleteContinue=!0,this.dele,this.deleteModaltype=e,this.caDeleteModalSysid=t,this.deleteModalCertName=s,this.deleteShowMessage="","ca"==e&&(this.caDeleteModelCount=0,this.certificates.forEach(e=>{e.parent_ca_sys_id===this.caDeleteModalSysid&&(this.caDeleteModelCount+=1)}));var n=document.getElementById("deleteModal");n.showModal()},async deleteModalContinue(){var e={};"cert"==this.deleteModaltype&&(e=await this.$refs.ApiConnect.send_get(`/delete/certificate/${this.caDeleteModalSysid}/${this.deleteModalCertName}/`,{},!0,!0)),"ca"==this.deleteModaltype&&(e=await this.$refs.ApiConnect.send_get(`/delete/certauthority/${this.caDeleteModalSysid}/`,{},!0,!0)),void 0!=e&&"result"in e&&"deleted_id"in e.result&&(this.showDeleteContinue=!1,this.deleteShowMessage="deleted successfully.")},hideModal:function(e){var t=document.getElementById(e);t.close(),"deleteModal"==e&&(this.get_authorities(),this.get_certificates())},showCertModal:async function(e,t){console.log(e,t),this.caModel_cert="";var s=await this.$refs.ApiConnect.send_get("/download/certificate/"+e+"/"+t+"/",{},!0,!0);this.crtModal_cert=s.result.cert,this.crtModal_key=s.result.key;var n=document.getElementById("viewcertModal");n.showModal()},hideCaModel:function(){var e=document.getElementById("viewCaModal");e.close()},hideCertModal:function(){var e=document.getElementById("viewcertModal");e.close()},applySearch:function(e){let t="",s=[],n=[];"cert"===e&&(t=this.certSearchterm,s=this.certificates),"ca"===e&&(t=this.caSearchterm,s=this.authorities),s.forEach(s=>{if(s){let a="-999999999999999999";"ca"==e&&(a=s.sys_id),"cert"==e&&(a=`${s.name}_${s.parent_ca_sys_id}`),(s.name.includes(t)||s.common_name.includes(t)||s.owner.includes(t)||s.status.includes(t)||a.includes(t))&&n.push(s)}}),"cert"===e&&(this.certificates_show=n),"ca"===e&&(this.authorities_show=n)},sortCertificates:function(e){let t=[],s="";"cert"===e&&(t=[...this.certificates],s=this.certFilterBy),"ca"===e&&(t=[...this.authorities],s=this.caFilterBy),console.log(e,this.certFilterBy),"name-asc"===s&&t.sort((e,t)=>e.name.localeCompare(t.name)),"oldest-newest"===s&&(t.sort((e,t)=>e.created-t.created),console.log("sorted oldest newest")),"newest-oldest"===s&&t.sort((e,t)=>t.created-e.created),"name-desc"===s&&t.sort((e,t)=>t.name.localeCompare(e.name)),"expiring-soonest"===s&&t.sort((e,t)=>e.remaining_days-t.remaining_days),"cert"===e&&(this.certificates_show=t),"ca"===e&&(this.authorities_show=t)}},async mounted(){await Promise.all([this.get_certificates(),this.get_authorities()]),this.$route.query.search&&(this.certSearchterm=this.$route.query.search,this.caSearchterm=this.$route.query.search,this.applySearch("ca"),this.applySearch("cert"))}};const ze=(0,v.A)(Xe,[["render",Ue],["__scopeId","data-v-2bf2d458"]]);var Re=ze;const Be={style:{width:"80vw",height:"80vh","margin-left":"auto","margin-right":"auto","margin-top":"30px"}},Ge={class:"glass_container",style:{height:"100%",padding:"10px"}},Je={class:"glass_container_divider",style:{width:"20vw",float:"left","text-align":"left",height:"calc(100% - 15px)"}},Qe=["onClick"],He={style:{"margin-bottom":"5px","font-size":"1.4em","text-transform":"uppercase"}},Ye={style:{"margin-top":"0px","margin-left":"5px","font-family":"monospace"}},Ze=["onClick"],et={class:"glass_container_divider",style:{width:"59vw",float:"right","text-align":"left",height:"calc(100% - 15px)"}},tt={key:0,style:{"font-size":"2em","margin-left":"15px"}},st={class:"glass_container",style:{padding:"10px",margin:"10px",width:"calc(58vw - 30px)"}},nt={style:{"margin-bottom":"5px","font-size":"1.05em","margin-left":"5px"}},at={style:{"margin-top":"0px","margin-left":"1.2em","font-family":"monospace"}},it=["onClick"];function ot(e,t,s,o,l,r){const c=(0,a.g2)("ApiConnect");return(0,a.uX)(),(0,a.CE)(a.FK,null,[(0,a.Lk)("div",Be,[t[17]||(t[17]=(0,a.Lk)("h2",{style:{"text-align":"left"}},"Relationships",-1)),(0,a.Lk)("div",Ge,[(0,a.Lk)("div",Je,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(this.authorities,s=>((0,a.uX)(),(0,a.CE)("div",{key:s.sys_id},[(0,a.Lk)("button",{class:(0,i.C4)(l.selected_node==s.sys_id?"glass-button-selected":"glass-button"),style:{padding:"10px"},onClick:e=>l.selected_node=s.sys_id},[(0,a.Lk)("h4",He," ðŸ”’Â Â "+(0,i.v_)(s.name),1),(0,a.Lk)("p",Ye,[(0,a.eW)(" Child certificates: "+(0,i.v_)(this.certificates.filter(e=>e.parent_ca_sys_id==s.sys_id).length)+" ",1),t[0]||(t[0]=(0,a.Lk)("br",null,null,-1)),t[1]||(t[1]=(0,a.eW)("Common Name: ",-1)),(0,a.Lk)("b",null,(0,i.v_)(s.common_name),1),t[2]||(t[2]=(0,a.eW)()),t[3]||(t[3]=(0,a.Lk)("br",null,null,-1)),t[4]||(t[4]=(0,a.eW)(" Created On: ",-1)),(0,a.Lk)("b",null,(0,i.v_)(r.unix_to_ts(s.created)),1),t[5]||(t[5]=(0,a.Lk)("br",null,null,-1)),t[6]||(t[6]=(0,a.eW)("Days remaining: ",-1)),(0,a.Lk)("b",null,(0,i.v_)(s.remaining_days),1),t[7]||(t[7]=(0,a.Lk)("br",null,null,-1)),(0,a.eW)(" status: "+(0,i.v_)(s.status),1)]),(0,a.Lk)("button",{class:"glass-button",style:{"text-align":"center",width:"fit-content",padding:"10px"},onClick:t=>e.$router.push({path:"/",query:{search:s.sys_id}})},[...t[8]||(t[8]=[(0,a.eW)(" Details Â ",-1),(0,a.Lk)("img",{class:"icon",src:"/icons/zoom.png"},null,-1)])],8,Ze)],10,Qe),t[9]||(t[9]=(0,a.Lk)("br",null,null,-1))]))),128))]),(0,a.Lk)("div",et,[(0,a.Lk)("div",null,[void 0==l.certificates||0==l.certificates.length?((0,a.uX)(),(0,a.CE)("p",tt,"No certificates found.")):(0,a.Q3)("",!0),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(this.certificates,s=>(0,a.bo)(((0,a.uX)(),(0,a.CE)("div",{key:s.name},[(0,a.Lk)("div",st,[(0,a.Lk)("h4",nt,(0,i.v_)(s.name),1),(0,a.Lk)("p",at,[t[10]||(t[10]=(0,a.eW)("Common Name: ",-1)),(0,a.Lk)("b",null,(0,i.v_)(s.common_name),1),t[11]||(t[11]=(0,a.eW)()),t[12]||(t[12]=(0,a.Lk)("br",null,null,-1)),t[13]||(t[13]=(0,a.eW)(" Created On: ",-1)),(0,a.Lk)("b",null,(0,i.v_)(r.unix_to_ts(s.created)),1),t[14]||(t[14]=(0,a.Lk)("br",null,null,-1)),t[15]||(t[15]=(0,a.eW)(" Days remaining: ",-1)),(0,a.Lk)("b",null,(0,i.v_)(s.remaining_days),1),(0,a.eW)(" (status::"+(0,i.v_)(s.status)+")",1)]),(0,a.Lk)("button",{class:"glass-button",style:{"text-align":"center",width:"fit-content",padding:"10px"},onClick:t=>e.$router.push({path:"/",query:{search:`${s.name}_${s.parent_ca_sys_id}`}})},[...t[16]||(t[16]=[(0,a.eW)(" Details Â ",-1),(0,a.Lk)("img",{class:"icon",src:"/icons/zoom.png"},null,-1)])],8,it)])])),[[n.aG,l.selected_node==s.parent_ca_sys_id]])),128))])])])]),(0,a.bF)(c,{ref:"ApiConnect"},null,512)],64)}var lt={name:"TreeView",components:{ApiConnect:w},data(){return{authorities:[],certificates:[],selected_node:null}},methods:{unix_to_ts(e){const t=new Date(1e3*e);return t.toLocaleString()},async get_authorities(){var e=await this.$refs.ApiConnect.send_get("/list/certauthority/",{},!0);void 0!=e&&"result"in e&&(console.log(e),this.authorities=e.result,this.authorities_show=e.result,0==this.authorities.length&&_.emit("notificationGetStarted",!0))},async get_certificates(){var e=await this.$refs.ApiConnect.send_get("/list/certificates/",{},!0);void 0!=e&&"result"in e&&(this.certificates=e.result,this.certificates_show=e.result)}},async mounted(){await this.get_authorities(),this.get_certificates(),null!=this.selected_node&&this.selected_node.length>0&&(this.selected_node=this.authorities[0]["sys_id"])}};const rt=(0,v.A)(lt,[["render",ot],["__scopeId","data-v-53eec656"]]);var ct=rt;const dt={style:{width:"40vw","margin-left":"auto","margin-right":"auto","margin-top":"20px"}},ut={style:{"text-align":"left","margin-left":"0vw"}},pt={class:"outer_container",style:{"margin-left":"auto","margin-right":"auto","padding-bottom":"0px"}},ht={class:"holder"},gt={style:{"text-align":"center","margin-left":"auto","margin-right":"auto"}},mt={key:0},yt={key:1},ft={key:2};function kt(e,t,s,n,o,l){const r=(0,a.g2)("CreateCertWindow"),c=(0,a.g2)("CreateCaWindow");return(0,a.uX)(),(0,a.CE)("div",dt,[t[7]||(t[7]=(0,a.Lk)("br",null,null,-1)),(0,a.Lk)("h2",ut,"CREATE "+(0,i.v_)(o.certificateType in o.resolveNiceName?o.resolveNiceName[o.certificateType]:""),1),(0,a.Lk)("div",pt,[(0,a.Lk)("div",ht,[(0,a.Lk)("div",gt,[void 0==this.certificateType?((0,a.uX)(),(0,a.CE)("div",mt,[t[5]||(t[5]=(0,a.Lk)("h2",null,"Select Certificate Type",-1)),t[6]||(t[6]=(0,a.Lk)("br",null,null,-1)),(0,a.Lk)("div",null,[(0,a.Lk)("button",{style:{width:"200px",height:"200px"},class:"glass-button",onClick:t[0]||(t[0]=e=>this.certificateType="ca")},[...t[2]||(t[2]=[(0,a.Lk)("img",{class:"icon",src:"/icons/flow_diagram.png"},null,-1),(0,a.Lk)("br",null,null,-1),(0,a.Lk)("br",null,null,-1),(0,a.Lk)("b",null," Certificate Authority ",-1),(0,a.Lk)("p",{style:{color:"white","font-size":"0.9em"}},"A certificate that can be used to establish a chain of trust",-1)])]),t[4]||(t[4]=(0,a.eW)(" Â  ",-1)),(0,a.Lk)("button",{style:{width:"200px",height:"200px"},class:"glass-button",onClick:t[1]||(t[1]=e=>this.certificateType="cert")},[...t[3]||(t[3]=[(0,a.Lk)("img",{class:"icon",src:"/icons/certificate.png"},null,-1),(0,a.Lk)("br",null,null,-1),(0,a.Lk)("br",null,null,-1),(0,a.Lk)("b",null," Certificate ",-1),(0,a.Lk)("p",{style:{color:"white","font-size":"0.9em"}}," A certificate that can be used on a server within the realm of an authority",-1)])])])])):(0,a.Q3)("",!0),"cert"==this.certificateType?((0,a.uX)(),(0,a.CE)("div",yt,[(0,a.bF)(r)])):(0,a.Q3)("",!0),"ca"==this.certificateType?((0,a.uX)(),(0,a.CE)("div",ft,[(0,a.bF)(c)])):(0,a.Q3)("",!0)])])])])}const _t={style:{"text-align":"center",width:"100%","margin-left":"auto","margin-right":"auto"}},bt={style:{"text-align":"left","margin-top":"10px"}};function vt(e,t,s,o,l,r){const c=(0,a.g2)("DropDown"),d=(0,a.g2)("CertificateSubj"),u=(0,a.g2)("ApiConnect");return(0,a.uX)(),(0,a.CE)(a.FK,null,[(0,a.Lk)("div",_t,[t[5]||(t[5]=(0,a.Lk)("h3",null,"Certificate Metadata",-1)),(0,a.bo)((0,a.Lk)("input",{style:{display:"grid","margin-top":"10px",width:"-webkit-fill-available"},"onUpdate:modelValue":t[0]||(t[0]=e=>this.certName=e),type:"text",id:"name",name:"name",placeholder:"New Certificate Authority Name"},null,512),[[n.Jo,this.certName]]),(0,a.bo)((0,a.Lk)("input",{style:{display:"grid","margin-top":"10px",width:"-webkit-fill-available"},"onUpdate:modelValue":t[1]||(t[1]=e=>this.keyphrase=e),type:"password",id:"password",name:"password",placeholder:"Certificate Authority Keyphrase"},null,512),[[n.Jo,this.keyphrase]]),(0,a.Lk)("div",bt,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[2]||(t[2]=e=>this.valid_days=e),type:"number",style:{"text-align":"left","margin-right":"auto"},placeholder:"Validity Days"},null,512),[[n.Jo,this.valid_days]])]),t[6]||(t[6]=(0,a.Lk)("h3",null,"Key Size",-1)),(0,a.bF)(c,{style:{width:"-webkit-fill-available","font-size":"1.0em",display:"inline-flex"},modelValue:this.keysize,"onUpdate:modelValue":t[3]||(t[3]=e=>this.keysize=e),options:l.keysize_options,placeholder:"Select keysize"},null,8,["modelValue","options"]),(0,a.bF)(d,{style:{display:"grid"},ref:"CertificateSubj"},null,512),(0,a.Lk)("button",{class:"glass-button",onClick:t[4]||(t[4]=e=>r.createCert())},(0,i.v_)(this.createButtontext),1)]),(0,a.bF)(u,{ref:"ApiConnect"},null,512)],64)}function Lt(e,t,s,i,o,l){return(0,a.uX)(),(0,a.CE)("div",null,[t[7]||(t[7]=(0,a.Lk)("h3",{style:{}},"Certificate Subject Data",-1)),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>this.subjectData.common_name=e),type:"text",id:"common_name",name:"common_name",placeholder:"Common Name (example.com) [CN=example.com]"},null,512),[[n.Jo,this.subjectData.common_name]]),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>this.subjectData.organisation_name=e),type:"text",id:"organisation_name",name:"organisation_name",placeholder:"Organisation Name (Example) [O=Example]"},null,512),[[n.Jo,this.subjectData.organisation_name]]),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[2]||(t[2]=e=>this.subjectData.organisational_unit_name=e),type:"text",id:"organisational_unit_name",name:"organisational_unit_name",placeholder:"Organisation Unit Name (IT_Department) [OU=IT Department]"},null,512),[[n.Jo,this.subjectData.organisational_unit_name]]),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[3]||(t[3]=e=>this.subjectData.email=e),type:"text",id:"email",name:"email",placeholder:"Email (mrrobot@example.com) [emailAddress=mrrobot@example.com]"},null,512),[[n.Jo,this.subjectData.email]]),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[4]||(t[4]=e=>this.subjectData.locality=e),type:"text",id:"locality",name:"locality",placeholder:"Locality (Little Town) [L=Little Town]"},null,512),[[n.Jo,this.subjectData.locality]]),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[5]||(t[5]=e=>this.subjectData.state=e),type:"text",id:"state",name:"state",placeholder:"State (Greater London) [ST=Greater London]"},null,512),[[n.Jo,this.subjectData.state]]),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[6]||(t[6]=e=>this.subjectData.country=e),type:"text",id:"country",name:"country",placeholder:"Country (UK) [C=UK]"},null,512),[[n.Jo,this.subjectData.country]])])}var wt={name:"CertificateSubj",components:{},data(){return{subjectData:{common_name:void 0,organisation_name:void 0,organisational_unit_name:void 0,email:void 0,locality:void 0,state:void 0,country:void 0}}},methods:{returnPayload:function(){let e={};for(var t in this.subjectData)console.log(t,this.subjectData[t]),void 0!=this.subjectData[t]&&""!=this.subjectData[t]&&(e[t]=this.subjectData[t]);return e}}};const Ct=(0,v.A)(wt,[["render",Lt],["__scopeId","data-v-25ff28c0"]]);var xt=Ct,At={name:"CreateCaWindow",components:{ApiConnect:w,DropDown:Ke,CertificateSubj:xt},data(){return{keyphrase:"",certName:"",valid_days:null,keysize_options:[{emitValue:2048,displayName:"2048 bits"},{emitValue:3072,displayName:"3072 bits"},{emitValue:4096,displayName:"4096 bits"}],keysize:0,successfullyCreated:!1,createdId:void 0,createButtontext:"Create"}},methods:{unix_to_ts(e){const t=new Date(1e3*e);return t.toLocaleString()},async createCert(){if(this.successfullyCreated)this.$refs.ApiConnect.download_authority_buffered(this.createdId);else if(""!=this.certName){var e={keyphrase:this.keyphrase,name:this.certName,ca_days_length:this.valid_days};this.keysize>0&&(e["ca_keysize"]=this.keysize);var t=this.$refs.CertificateSubj.returnPayload(),s={...e,...t};console.log(s);var n=await this.$refs.ApiConnect.send_post("/create/certauthority/",s,{},!1);void 0!=n&&"result"in n&&"id"in n.result&&(this.successfullyCreated=!0,this.createdId=n["result"]["id"],this.createButtontext="Download",this.$refs.ApiConnect.download_authority_buffered(this.createdId),this.$router.push("/"))}else _.emit("notificationContent",{type:"error",content:"A new certificate must have a name"})}},mounted(){}};const St=(0,v.A)(At,[["render",vt],["__scopeId","data-v-aab62cc8"]]);var Mt=St;const Dt={style:{"text-align":"center",width:"100%","margin-left":"auto","margin-right":"auto"}},Et={style:{"text-align":"left","margin-top":"10px"}};function It(e,t,s,o,l,r){const c=(0,a.g2)("DropDown"),d=(0,a.g2)("CertificateSubj"),u=(0,a.g2)("ApiConnect");return(0,a.uX)(),(0,a.CE)(a.FK,null,[(0,a.Lk)("div",Dt,[t[6]||(t[6]=(0,a.Lk)("h3",null,"Certificate Metadata",-1)),(0,a.bo)((0,a.Lk)("input",{style:{display:"grid","margin-top":"10px",width:"-webkit-fill-available"},"onUpdate:modelValue":t[0]||(t[0]=e=>this.certName=e),type:"text",id:"name",name:"name",placeholder:"New Certificate Name"},null,512),[[n.Jo,this.certName]]),(0,a.bF)(c,{style:{width:"-webkit-fill-available",display:"inline-flex"},modelValue:this.selected_authority_sysid,"onUpdate:modelValue":t[1]||(t[1]=e=>this.selected_authority_sysid=e),options:this.authorities_dropdown,placeholder:"Select a parent certificate authority"},null,8,["modelValue","options"]),(0,a.bo)((0,a.Lk)("input",{style:{display:"grid","margin-top":"10px",width:"-webkit-fill-available"},"onUpdate:modelValue":t[2]||(t[2]=e=>this.keyphrase=e),type:"password",id:"password",name:"password",placeholder:"Certificate authority keyphrase"},null,512),[[n.Jo,this.keyphrase]]),(0,a.Lk)("div",Et,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[3]||(t[3]=e=>this.valid_days=e),type:"number",style:{"text-align":"left","margin-right":"auto"},placeholder:"Validity Days"},null,512),[[n.Jo,this.valid_days]])]),t[7]||(t[7]=(0,a.Lk)("h3",null,"Key Size",-1)),(0,a.bF)(c,{style:{width:"-webkit-fill-available","font-size":"1.0em",display:"inline-flex"},modelValue:this.keysize,"onUpdate:modelValue":t[4]||(t[4]=e=>this.keysize=e),options:l.keysize_options,placeholder:"Select keysize"},null,8,["modelValue","options"]),(0,a.bF)(d,{style:{display:"grid"},ref:"CertificateSubj"},null,512),(0,a.Lk)("button",{class:"glass-button",onClick:t[5]||(t[5]=e=>r.createCert())},(0,i.v_)(this.createButtontext),1)]),(0,a.bF)(u,{ref:"ApiConnect"},null,512)],64)}var Pt={name:"CreateCertWindow",components:{ApiConnect:w,DropDown:Ke,CertificateSubj:xt},data(){return{authorities:[],authorities_dropdown:[],selected_authority_sysid:void 0,keyphrase:"",certName:"",valid_days:null,keysize_options:[{emitValue:2048,displayName:"2048 bits"},{emitValue:3072,displayName:"3072 bits"},{emitValue:4096,displayName:"4096 bits"}],keysize:0,successfullyCreated:!1,createButtontext:"Create"}},methods:{async get_authorities(){var e=await this.$refs.ApiConnect.send_get("/list/certauthority/",{},!0);if(void 0!=e&&"result"in e)return console.log(e),this.authorities=e.result,e.result},populate_authority_dropdown(e){e.forEach(e=>{this.authorities_dropdown.push({displayName:`Common Name: ${e.common_name}, Created: ${this.unix_to_ts(e.created)}`,emitValue:e.sys_id})})},unix_to_ts(e){const t=new Date(1e3*e);return t.toLocaleString()},async createCert(){if(this.successfullyCreated)this.$refs.ApiConnect.download_certificate_buffered(this.selected_authority_sysid,this.certName);else if(void 0!=this.selected_authority_sysid)if(""!=this.certName){var e={keyphrase:this.keyphrase,name:this.certName,cert_days_length:this.valid_days,ca_name:this.authorities.filter(e=>e.sys_id==this.selected_authority_sysid)[0]["name"]};this.keysize>0&&(e["keysize"]=this.keysize);var t=this.$refs.CertificateSubj.returnPayload(),s={...e,...t};console.log(s);var n=await this.$refs.ApiConnect.send_post(`/create/certificate/${this.selected_authority_sysid}/`,s,{},!1);void 0!=n&&"result"in n&&"cert"in n.result&&(this.successfullyCreated=!0,this.createButtontext="Download",this.$refs.ApiConnect.download_certificate_buffered(this.selected_authority_sysid,this.certName),this.$router.push("/"))}else _.emit("notificationContent",{type:"error",content:"A new certificate must have a name"});else _.emit("notificationContent",{type:"error",content:"A parent certificate authority must be selected"})}},mounted(){this.get_authorities().then(e=>{this.populate_authority_dropdown(e)})}};const jt=(0,v.A)(Pt,[["render",It],["__scopeId","data-v-ac25dfcc"]]);var Ut=jt,$t={name:"CreateCert",components:{CreateCertWindow:Ut,CreateCaWindow:Mt},data(){return{certificateType:void 0,resolveNiceName:{ca:"Certificate Authority",cert:"Certificate"}}},mounted(){this.$route.query.show&&(this.certificateType=this.$route.query.show)}};const Ft=(0,v.A)($t,[["render",kt],["__scopeId","data-v-c3d2313e"]]);var Nt=Ft;const Vt={style:{width:"80vw",height:"80vh","margin-left":"auto","margin-right":"auto","margin-top":"30px"}},Tt={class:"glass_container",style:{height:"100%",padding:"10px"}},Wt={class:"glass_container_divider",style:{width:"20vw",float:"left","text-align":"left",height:"calc(100% - 15px)"}},Ot={class:"glass_container_divider",style:{width:"59vw",float:"right","text-align":"left",height:"calc(100% - 15px)"}};function qt(e,t,s,n,o,l){const r=(0,a.g2)("AboutMe"),c=(0,a.g2)("ManageUsers"),d=(0,a.g2)("SystemLogs");return(0,a.uX)(),(0,a.CE)("div",Vt,[t[10]||(t[10]=(0,a.Lk)("h2",{style:{"text-align":"left"}},"SETTINGS",-1)),(0,a.Lk)("div",Tt,[(0,a.Lk)("div",Wt,[(0,a.Lk)("button",{class:(0,i.C4)("user_profile"==this.selected_setting?"glass-button-selected":"glass-button"),onClick:t[0]||(t[0]=e=>this.selected_setting="user_profile")},[...t[4]||(t[4]=[(0,a.Lk)("img",{class:"icon",src:"/icons/administrator.png"},null,-1),(0,a.eW)("Â  User Profile",-1)])],2),t[8]||(t[8]=(0,a.Lk)("br",null,null,-1)),(0,a.Lk)("button",{class:(0,i.C4)("manage_users"==this.selected_setting?"glass-button-selected":"glass-button"),onClick:t[1]||(t[1]=e=>this.selected_setting="manage_users")},[...t[5]||(t[5]=[(0,a.Lk)("img",{class:"icon",src:"/icons/group.png"},null,-1),(0,a.eW)("Â Â Manage Other Users",-1)])],2),t[9]||(t[9]=(0,a.Lk)("br",null,null,-1)),(0,a.Lk)("button",{class:(0,i.C4)("system_logs"==this.selected_setting?"glass-button-selected":"glass-button"),onClick:t[2]||(t[2]=e=>this.selected_setting="system_logs")},[...t[6]||(t[6]=[(0,a.Lk)("img",{class:"icon",src:"/icons/contract.png"},null,-1),(0,a.eW)("Â Â System Logs",-1)])],2),(0,a.Lk)("button",{class:(0,i.C4)("certificiate_wizzard"==this.selected_setting?"glass-button-selected":"glass-button"),onClick:t[3]||(t[3]=t=>e.$router.push({path:"/createcert"}))},[...t[7]||(t[7]=[(0,a.Lk)("img",{class:"icon",src:"/icons/wizard.png"},null,-1),(0,a.eW)("Â Â Certificate Wizard",-1)])],2)]),(0,a.Lk)("div",Ot,["user_profile"==this.selected_setting?((0,a.uX)(),(0,a.Wv)(r,{key:0})):(0,a.Q3)("",!0),"manage_users"==this.selected_setting?((0,a.uX)(),(0,a.Wv)(c,{key:1})):(0,a.Q3)("",!0),"system_logs"==this.selected_setting?((0,a.uX)(),(0,a.Wv)(d,{key:2})):(0,a.Q3)("",!0)])])])}const Kt={style:{"margin-left":"15px"}},Xt={style:{display:"inline-block"}},zt={style:{"margin-top":"3px"}},Rt={cellpadding:"8",cellspacing:"0",class:"table_container",style:{"margin-bottom":"10px"}},Bt={style:{"font-weight":"500"}},Gt={style:{color:"bisque"}},Jt={style:{display:"inline-block"}},Qt={id:"apikeystbl",cellpadding:"8",cellspacing:"0",class:"table_container",style:{"margin-bottom":"10px"}},Ht={style:{"font-weight":"500"}},Yt=["onClick"];function Zt(e,t,s,n,o,l){const r=(0,a.g2)("PasswordModal"),c=(0,a.g2)("ApiKeyCreate"),d=(0,a.g2)("ApiConnect");return(0,a.uX)(),(0,a.CE)(a.FK,null,[(0,a.Lk)("div",Kt,[(0,a.bF)(r,{ref:"PasswordModal"},null,512),(0,a.bF)(c,{ref:"ApiKeyCreate"},null,512),t[6]||(t[6]=(0,a.Lk)("br",null,null,-1)),t[7]||(t[7]=(0,a.Lk)("div",{style:{height:"70px",display:"inline-block","vertical-align":"top"}},[(0,a.Lk)("img",{style:{height:"100%"},src:"/icons/user.png"}),(0,a.eW)("Â  ")],-1)),(0,a.Lk)("div",Xt,[(0,a.Lk)("h3",null,(0,i.v_)(this.UserProfile.username||"Not populated"),1),(0,a.Lk)("p",zt,[t[2]||(t[2]=(0,a.Lk)("b",null,"Active Since:",-1)),(0,a.eW)(" "+(0,i.v_)(l.unix_to_ts(this.UserProfile.created)),1)]),(0,a.Lk)("button",{onClick:t[0]||(t[0]=t=>e.$refs.PasswordModal.showModal()),class:"glass-button",style:{"margin-left":"0px"}},[...t[3]||(t[3]=[(0,a.Lk)("img",{class:"icon",src:"/icons/password.png"},null,-1),(0,a.eW)("Â Change User Password",-1)])])]),t[8]||(t[8]=(0,a.Lk)("p",{style:{"margin-bottom":"5px"}},[(0,a.Lk)("b",null,"Roles:")],-1)),(0,a.Lk)("table",Rt,[t[4]||(t[4]=(0,a.Lk)("thead",null,[(0,a.Lk)("tr",null,[(0,a.Lk)("th",null,"Role"),(0,a.Lk)("th",null,"Permission")])],-1)),(0,a.Lk)("tbody",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(JSON.parse(this.UserProfile.roles),e=>((0,a.uX)(),(0,a.CE)("tr",{key:e},[(0,a.Lk)("td",Bt,(0,i.v_)(e),1),(0,a.Lk)("td",null,[(0,a.Lk)("i",Gt,(0,i.v_)(o.RoleDescription[e]),1)])]))),128))])]),t[9]||(t[9]=(0,a.Lk)("br",null,null,-1)),t[10]||(t[10]=(0,a.Lk)("br",null,null,-1)),(0,a.Lk)("h3",Jt,"API Keys ("+(0,i.v_)(o.ApiKeys.length)+")",1),t[11]||(t[11]=(0,a.eW)()),(0,a.Lk)("button",{style:{display:"inline-block",margin:"5px",padding:"5px"},class:"glass-button",onClick:t[1]||(t[1]=t=>e.$refs.ApiKeyCreate.showModal())},"Create Key"),(0,a.Lk)("table",Qt,[t[5]||(t[5]=(0,a.Lk)("thead",null,[(0,a.Lk)("tr",null,[(0,a.Lk)("th",null,"ID"),(0,a.Lk)("th",null,"Created"),(0,a.Lk)("th",null,"Expires"),(0,a.Lk)("th",null,"Roles"),(0,a.Lk)("th",null,"Action")])],-1)),(0,a.Lk)("tbody",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(this.ApiKeys,e=>((0,a.uX)(),(0,a.CE)("tr",{key:e.username},[(0,a.Lk)("td",Ht,(0,i.v_)(e.username),1),(0,a.Lk)("td",null,(0,i.v_)(l.unix_to_ts(e.created)),1),(0,a.Lk)("td",null,(0,i.v_)(l.unix_to_ts(e.expires)),1),(0,a.Lk)("td",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(JSON.parse(e.roles),e=>((0,a.uX)(),(0,a.CE)("p",{key:e,style:{"margin-top":"3px","margin-left":"15px",color:"bisque"}},[(0,a.eW)((0,i.v_)(` ${e}`)+" ",1),(0,a.Lk)("i",null,(0,i.v_)(o.RoleDescription[e]),1)]))),128))]),(0,a.Lk)("td",null,[(0,a.Lk)("button",{class:"glass-button",onClick:t=>l.delete_apikeys(e.username),style:{"margin-right":"5px",padding:"5px"}},"ðŸ—‘ï¸",8,Yt)])]))),128))])])]),(0,a.bF)(d,{ref:"ApiConnect"},null,512)],64)}const es={id:"apiKeyCreate",class:"modal"},ts={class:"holder"},ss={style:{"text-align":"left","margin-right":"auto",padding:"10px"}},ns={style:{"text-align":"center","margin-left":"auto","margin-right":"auto"}};function as(e,t,s,o,l,r){const c=(0,a.g2)("DropDownCheckbox"),d=(0,a.g2)("ApiConnect");return(0,a.uX)(),(0,a.CE)(a.FK,null,[(0,a.Lk)("div",null,[(0,a.Lk)("dialog",es,[(0,a.Lk)("button",{autofocus:"",class:"close-btn",onClick:t[0]||(t[0]=e=>r.hideModal())},"x"),t[11]||(t[11]=(0,a.Lk)("h2",null,"Create API Key",-1)),(0,a.Lk)("div",ts,[t[10]||(t[10]=(0,a.Lk)("br",null,null,-1)),(0,a.Lk)("div",ss,[t[6]||(t[6]=(0,a.Lk)("p",{style:{}},"Create an API key. Note that permissions cannot be changed after creation.",-1)),(0,a.bF)(c,{style:{"text-align":"left"},options:this.permissionsOpts,already_selected:[],modelValue:this.selectedPerms,"onUpdate:modelValue":t[1]||(t[1]=e=>this.selectedPerms=e),placeholder:"Select permissions"},null,8,["options","modelValue"]),(0,a.bo)((0,a.Lk)("input",{class:"short-input","onUpdate:modelValue":t[2]||(t[2]=e=>this.valid_days=e),type:"number",style:{"text-align":"left","margin-top":"10px",width:"30px"},placeholder:"Validity Days"},null,512),[[n.Jo,this.valid_days]]),t[7]||(t[7]=(0,a.Lk)("br",null,null,-1)),t[8]||(t[8]=(0,a.Lk)("br",null,null,-1)),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[3]||(t[3]=e=>this.apiKey=e),type:"text",id:"apikey",name:"apikey",placeholder:"Generate Key",style:{"font-family":"monospace",width:"300px",display:"inline-block","vertical-align":"middle"},readonly:""},null,512),[[n.Jo,this.apiKey]]),t[9]||(t[9]=(0,a.eW)(" Â  ",-1)),(0,a.Lk)("button",{style:{display:"inline-block","vertical-align":"middle","margin-bottom":"10px"},class:"glass-button",onClick:t[4]||(t[4]=e=>r.copyValue())},"Copy"),(0,a.Lk)("p",null,(0,i.v_)(this.changeStatus),1)]),(0,a.Lk)("div",ns,[(0,a.Lk)("button",{class:"glass-button",onClick:t[5]||(t[5]=e=>r.generateKey())},"Create Key")])])])]),(0,a.bF)(d,{ref:"ApiConnect"},null,512)],64)}const is={ref:"dropdownRef",class:"dropdown-container"},os={key:0,class:"dropdown-list"},ls={class:"holder"},rs=["onClick"],cs=["value"];function ds(e,t,s,o,l,r){return(0,a.uX)(),(0,a.CE)("div",is,[(0,a.Lk)("button",{style:{},class:"dropdown-button",onClick:t[0]||(t[0]=(...e)=>r.toggleDropdown&&r.toggleDropdown(...e))},[(0,a.eW)((0,i.v_)(l.selectedText||s.placeholder)+" ",1),t[2]||(t[2]=(0,a.Lk)("span",{class:"arrow"},"â–¾",-1))]),l.open?((0,a.uX)(),(0,a.CE)("div",os,[(0,a.Lk)("div",ls,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(l.opts,e=>((0,a.uX)(),(0,a.CE)("button",{key:e.emitValue,class:"dropdown-item",onClick:t=>r.selectOption(e)},[(0,a.bo)((0,a.Lk)("input",{style:{"vertical-align":"middle"},type:"checkbox",id:"something","onUpdate:modelValue":t[1]||(t[1]=e=>l.already_opts=e),value:e.emitValue},null,8,cs),[[n.lH,l.already_opts]]),(0,a.eW)(" "+(0,i.v_)(e.displayName),1)],8,rs))),128))])])):(0,a.Q3)("",!0)],512)}var us={name:"DropDownCheckbox",props:{options:{type:Array,required:!0},already_selected:{type:Array,required:!0},placeholder:{type:String,default:"Select an option"}},data(){return{opts:[],already_opts:[],open:!1,selectedText:`${this.already_selected.length} selected`}},mounted(){this.opts=this.options,this.already_opts=[...this.already_selected]},emits:["update:modelValue","updateFilter"],methods:{toggleDropdown(){this.open=!this.open},selectOption(e){const t=this.already_opts.indexOf(e.emitValue);t>-1?this.already_opts.splice(t,1):this.already_opts.push(e.emitValue),this.selectedText=`${this.already_opts.length} selected`,this.$emit("update:modelValue",this.already_opts),this.$emit("updateFilter",this.already_opts)}}};const ps=(0,v.A)(us,[["render",ds],["__scopeId","data-v-222bd67d"]]);var hs=ps,gs={name:"ApiKeyCreate",components:{ApiConnect:w,DropDownCheckbox:hs},data(){return{apiKey:"",changeStatus:".",valid_days:null,selectedPerms:[],permissionsOpts:[{displayName:"Inherit all permissions",emitValue:"*"},{displayName:"Read all certificate data",emitValue:"read"},{displayName:"Write certificate data",emitValue:"write"},{displayName:"Manage user information",emitValue:"manage_users"}]}},methods:{showModal:function(){console.log("showingApiKeyCreate");var e=document.getElementById("apiKeyCreate");e.showModal()},hideModal:function(){console.log("hidingApiKeyCreate");var e=document.getElementById("apiKeyCreate");e.close()},generateKey:async function(){const e={roles:this.selectedPerms,days_expiry:this.valid_days};var t=await this.$refs.ApiConnect.send_post("/user/apikeys/create/",e,{},!1);void 0!=t&&"errors"in t&&t["errors"].length>0&&(this.changeStatus=t["errors"][0]),void 0!=t&&"result"in t?(this.apiKey=t["result"]["token"],this.changeStatus="This value will only be shown once."):this.changeStatus="Error creating key"},copyValue:function(){navigator.clipboard.writeText(this.apiKey).then(()=>{this.changeStatus="Copied!"}).catch(e=>{this.changeStatus="Copy failed.",console.error(e)})}}};const ms=(0,v.A)(gs,[["render",as],["__scopeId","data-v-5383b91c"]]);var ys=ms;const fs={id:"setPassword",class:"modal"},ks={class:"holder"},_s={style:{"text-align":"center","margin-left":"auto","margin-right":"auto"}};function bs(e,t,s,o,l,r){const c=(0,a.g2)("ApiConnect");return(0,a.uX)(),(0,a.CE)(a.FK,null,[(0,a.Lk)("div",null,[(0,a.Lk)("dialog",fs,[(0,a.Lk)("button",{autofocus:"",class:"close-btn",onClick:t[0]||(t[0]=e=>r.hideModal())},"x"),t[12]||(t[12]=(0,a.Lk)("h2",null,"Change Password",-1)),(0,a.Lk)("div",ks,[t[11]||(t[11]=(0,a.Lk)("br",null,null,-1)),(0,a.Lk)("div",_s,[(0,a.bo)((0,a.Lk)("input",{onKeyup:t[1]||(t[1]=(0,n.jR)((...t)=>e.do_login&&e.do_login(...t),["enter"])),"onUpdate:modelValue":t[2]||(t[2]=e=>this.currentPass=e),type:"password",id:"passwordold",name:"password",placeholder:"CURRENT USER PASSWORD",required:""},null,544),[[n.Jo,this.currentPass]]),t[8]||(t[8]=(0,a.Lk)("br",null,null,-1)),(0,a.bo)((0,a.Lk)("input",{style:{"margin-top":"2px"},onInput:t[3]||(t[3]=(...e)=>r.checkStatus&&r.checkStatus(...e)),"onUpdate:modelValue":t[4]||(t[4]=e=>this.newPass1=e),type:"password",id:"password1",name:"password",placeholder:"NEW PASSWORD",required:""},null,544),[[n.Jo,this.newPass1]]),t[9]||(t[9]=(0,a.Lk)("br",null,null,-1)),(0,a.bo)((0,a.Lk)("input",{onInput:t[5]||(t[5]=(...e)=>r.checkStatus&&r.checkStatus(...e)),"onUpdate:modelValue":t[6]||(t[6]=e=>this.newPass2=e),type:"password",id:"password",name:"password2",placeholder:"VERIFY NEW PASSWORD",required:""},null,544),[[n.Jo,this.newPass2]]),t[10]||(t[10]=(0,a.Lk)("br",null,null,-1)),(0,a.Lk)("p",null,(0,i.v_)(this.changeStatus),1),(0,a.Lk)("button",{class:"glass-button",onClick:t[7]||(t[7]=e=>r.changePassword())},"SAVE")])])])]),(0,a.bF)(c,{ref:"ApiConnect"},null,512)],64)}var vs={name:"PasswordModal",components:{ApiConnect:w},data(){return{currentPass:"",newPass1:"",newPass2:"",changeStatus:"",requestedFor:null}},methods:{showModal:function(e){this.requestedFor=e,console.log("showing password");var t=document.getElementById("setPassword");t.showModal()},hideModal:function(){console.log("hiding password");var e=document.getElementById("setPassword");e.close()},checkStatus:function(){return this.newPass1==this.newPass2||(this.changeStatus="Password do not match",!1)},changePassword:async function(){if(0==this.checkStatus())return;var e=void 0;if(void 0!=this.requestedFor)e=this.requestedFor;else{var t=this.$refs.ApiConnect.get_jwt();e=t["sub"]}const s={password:this.currentPass,new_password:this.newPass2};var n=await this.$refs.ApiConnect.send_post(`/user/resetpassword/${e}/`,s,{},!1);void 0!=n&&"errors"in n&&n["errors"].length>0&&(this.changeStatus=n["errors"][0]),void 0!=n&&"result"in n&&1==n["result"]?this.changeStatus="Changed password successfully.":this.changeStatus="Error changing password."}}};const Ls=(0,v.A)(vs,[["render",bs],["__scopeId","data-v-bd5c201a"]]);var ws=Ls,Cs={name:"AboutMe",components:{ApiConnect:w,PasswordModal:ws,ApiKeyCreate:ys},data(){return{UserProfile:{username:"sample_user",created:12345678,roles:'["*"]'},RoleDescription:{"*":"All functionality (inherits everything)",read:"Read all certificate data",write:"Write all certificate data",manage_users:"Create, delete and change password for a user"},ApiKeys:[]}},methods:{showPassword(){this.$refs.PasswordModal.showModal()},unix_to_ts(e){const t=new Date(1e3*e);return t.toLocaleString()},returnPayload:function(){let e={};for(var t in this.subjectData)console.log(t,this.subjectData[t]),void 0!=this.subjectData[t]&&""!=this.subjectData[t]&&(e[t]=this.subjectData[t]);return e},async get_apikeys(){var e=await this.$refs.ApiConnect.send_get("/user/apikeys/list/",{},!0);void 0!=e&&"result"in e&&"keys"in e["result"]&&(this.ApiKeys=e["result"]["keys"])},async get_user_details_me(){var e=await this.$refs.ApiConnect.send_get("/user/details/me/",{},!0);void 0!=e&&"result"in e&&"users"in e["result"]&&(this.UserProfile=e["result"]["users"][0])},async delete_apikeys(e){var t=await this.$refs.ApiConnect.send_get(`/user/apikeys/delete/${e}/`,{},!0);void 0!=t&&"result"in t&&1==t["result"]&&(_.emit("notificationContent",{type:"success",content:`Deleted API key: ${e}`}),this.get_apikeys())}},mounted(){this.get_apikeys(),this.get_user_details_me()}};const xs=(0,v.A)(Cs,[["render",Zt],["__scopeId","data-v-fd22c14e"]]);var As=xs;const Ss={style:{"margin-left":"15px"}},Ms={cellpadding:"8",cellspacing:"0",class:"table_container",style:{"margin-bottom":"10px"}},Ds={style:{"font-weight":"500"}},Es={style:{"text-align":"right"}},Is=["onClick"],Ps=["onClick"];function js(e,t,s,n,o,l){const r=(0,a.g2)("PasswordModal"),c=(0,a.g2)("UserCreate"),d=(0,a.g2)("DropDownCheckbox"),u=(0,a.g2)("ApiConnect"),p=(0,a.g2)("DeleteUser");return(0,a.uX)(),(0,a.CE)(a.FK,null,[(0,a.Lk)("div",Ss,[(0,a.bF)(r,{ref:"PasswordModal"},null,512),(0,a.bF)(c,{ref:"UserCreate"},null,512),t[7]||(t[7]=(0,a.Lk)("h3",null,"Manager Users",-1)),t[8]||(t[8]=(0,a.Lk)("br",null,null,-1)),(0,a.Lk)("button",{onClick:t[0]||(t[0]=t=>e.$refs.UserCreate.showModal()),class:"glass-button",style:{"margin-left":"0px"}},[...t[2]||(t[2]=[(0,a.Lk)("img",{class:"icon",src:"/icons/add.png"},null,-1),(0,a.eW)("Â Create New User",-1)])]),(0,a.Lk)("button",{onClick:t[1]||(t[1]=e=>{l.get_user_details(),l.notification({type:"success",content:"Refreshed users"})}),class:"glass-button",style:{"margin-left":"0px"}},[...t[3]||(t[3]=[(0,a.Lk)("img",{class:"icon",src:"/icons/refresh.png"},null,-1),(0,a.eW)("Â Refresh Users",-1)])]),(0,a.Lk)("table",Ms,[t[6]||(t[6]=(0,a.Lk)("thead",null,[(0,a.Lk)("tr",null,[(0,a.Lk)("th",{style:{width:"150px"}},"Username"),(0,a.Lk)("th",{style:{width:"150px"}},"Created"),(0,a.Lk)("th",{style:{"margin-right":"auto"}},"Permissions"),(0,a.Lk)("th",{style:{"text-align":"right"}},"Action")])],-1)),(0,a.Lk)("tbody",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(o.allProfiles,s=>((0,a.uX)(),(0,a.CE)("tr",{key:s.username},[(0,a.Lk)("td",Ds,(0,i.v_)(s.username),1),(0,a.Lk)("td",null,[(0,a.Lk)("i",null,(0,i.v_)(this.unix_to_ts(s.created)),1)]),(0,a.Lk)("td",null,[(0,a.bF)(d,{style:{"text-align":"left"},options:this.permissionsOpts,already_selected:JSON.parse(s.roles),placeholder:"Selected roles",onUpdateFilter:e=>l.update_roles(e,s.username)},null,8,["options","already_selected","onUpdateFilter"])]),(0,a.Lk)("td",Es,[(0,a.Lk)("button",{class:"glass-button",onClick:t=>e.$refs.DeleteUser.showModal(s.username),style:{"margin-right":"5px",padding:"5px"}},[...t[4]||(t[4]=[(0,a.Lk)("img",{class:"icon",src:"/icons/delete.png"},null,-1)])],8,Is),(0,a.Lk)("button",{class:"glass-button",onClick:t=>e.$refs.PasswordModal.showModal(s.username),style:{"margin-right":"5px",padding:"5px"}},[...t[5]||(t[5]=[(0,a.Lk)("img",{class:"icon",src:"/icons/lock.png"},null,-1)])],8,Ps)])]))),128))])]),t[9]||(t[9]=(0,a.Lk)("br",null,null,-1)),t[10]||(t[10]=(0,a.Lk)("br",null,null,-1))]),(0,a.bF)(u,{ref:"ApiConnect"},null,512),(0,a.bF)(p,{ref:"DeleteUser"},null,512)],64)}const Us={id:"deletUser",class:"modal"},$s={class:"holder"},Fs={style:{"text-align":"left","margin-right":"auto",padding:"10px"}},Ns={style:{}},Vs={style:{"text-align":"center","margin-left":"auto","margin-right":"auto"}};function Ts(e,t,s,n,o,l){const r=(0,a.g2)("ApiConnect");return(0,a.uX)(),(0,a.CE)(a.FK,null,[(0,a.Lk)("div",null,[(0,a.Lk)("dialog",Us,[(0,a.Lk)("button",{autofocus:"",class:"close-btn",onClick:t[0]||(t[0]=e=>l.hideModal())},"x"),t[9]||(t[9]=(0,a.Lk)("h2",null,"Delete User",-1)),(0,a.Lk)("div",$s,[t[8]||(t[8]=(0,a.Lk)("br",null,null,-1)),(0,a.Lk)("div",Fs,[(0,a.Lk)("p",Ns,[(0,a.eW)("This will delete the user: "+(0,i.v_)(this.for_user)+". ",1),t[2]||(t[2]=(0,a.Lk)("br",null,null,-1)),t[3]||(t[3]=(0,a.Lk)("br",null,null,-1)),t[4]||(t[4]=(0,a.eW)(" All API keys will be removed and active sessions will be terminated. ",-1)),t[5]||(t[5]=(0,a.Lk)("br",null,null,-1)),t[6]||(t[6]=(0,a.eW)(" Only do this if you are certain this account is no longer required.",-1))]),t[7]||(t[7]=(0,a.Lk)("br",null,null,-1)),(0,a.Lk)("p",{class:(0,i.C4)(this.successfull?"success":"normal")},(0,i.v_)(this.changeStatus),3)]),(0,a.Lk)("div",Vs,[this.successfull?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.CE)("button",{key:0,class:"glass-button",onClick:t[1]||(t[1]=e=>l.deleteUser())},"Delete User"))])])])]),(0,a.bF)(r,{ref:"ApiConnect"},null,512)],64)}var Ws={name:"DeleteUser",components:{ApiConnect:w},data(){return{for_user:"",changeStatus:".",successfull:!0}},methods:{showModal:function(e){this.for_user=e,this.successfull=!1,console.log("showingDeleteUser");var t=document.getElementById("deletUser");t.showModal()},hideModal:function(){console.log("hidingDeleteUser");var e=document.getElementById("deletUser");e.close()},deleteUser:async function(){const e={};var t=await this.$refs.ApiConnect.send_post(`/user/profile/${this.for_user}/delete/`,e,{},!1);void 0!=t&&"errors"in t&&t["errors"].length>0&&(this.changeStatus=t["errors"][0]),void 0!=t&&"result"in t&&"deleted_user"in t["result"]?(this.changeStatus=`Successfully deleted ${this.for_user}`,this.successfull=!0):this.changeStatus="Error deleting user"}}};const Os=(0,v.A)(Ws,[["render",Ts],["__scopeId","data-v-640c09bb"]]);var qs=Os;const Ks={id:"UserCreate",class:"modal"},Xs={class:"holder"},zs={style:{"text-align":"left","margin-right":"auto",padding:"10px"}},Rs={style:{"text-align":"center","margin-left":"auto","margin-right":"auto"}};function Bs(e,t,s,o,l,r){const c=(0,a.g2)("DropDownCheckbox"),d=(0,a.g2)("ApiConnect");return(0,a.uX)(),(0,a.CE)(a.FK,null,[(0,a.Lk)("div",null,[(0,a.Lk)("dialog",Ks,[(0,a.Lk)("button",{autofocus:"",class:"close-btn",onClick:t[0]||(t[0]=e=>r.hideModal())},"x"),t[10]||(t[10]=(0,a.Lk)("h2",null,"Create User",-1)),(0,a.Lk)("div",Xs,[t[9]||(t[9]=(0,a.Lk)("br",null,null,-1)),(0,a.Lk)("div",zs,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>this.username=e),type:"text",id:"username",name:"username",placeholder:"Username",style:{width:"300px",display:"inline-block","vertical-align":"middle"},required:""},null,512),[[n.Jo,this.username]]),(0,a.bF)(c,{style:{"text-align":"left"},options:this.permissionsOpts,already_selected:[],modelValue:this.selectedPerms,"onUpdate:modelValue":t[2]||(t[2]=e=>this.selectedPerms=e),placeholder:"Select permissions"},null,8,["options","modelValue"]),t[6]||(t[6]=(0,a.Lk)("br",null,null,-1)),t[7]||(t[7]=(0,a.Lk)("br",null,null,-1)),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[3]||(t[3]=e=>this.password=e),type:"text",id:"genpass",name:"genpass",placeholder:"Generated Password",style:{"font-family":"monospace",width:"300px",display:"inline-block","vertical-align":"middle"},readonly:""},null,512),[[n.Jo,this.password]]),t[8]||(t[8]=(0,a.eW)(" Â  ",-1)),(0,a.Lk)("button",{style:{display:"inline-block","vertical-align":"middle","margin-bottom":"10px"},class:"glass-button",onClick:t[4]||(t[4]=e=>r.copyValue())},"Copy"),(0,a.Lk)("p",null,(0,i.v_)(this.changeStatus),1)]),(0,a.Lk)("div",Rs,[(0,a.Lk)("button",{class:"glass-button",onClick:t[5]||(t[5]=e=>r.generateKey())},"Create User")])])])]),(0,a.bF)(d,{ref:"ApiConnect"},null,512)],64)}var Gs={name:"UserCreate",components:{ApiConnect:w,DropDownCheckbox:hs},data(){return{username:"",password:"",changeStatus:".",selectedPerms:[],permissionsOpts:[{displayName:"Inherit all permissions",emitValue:"*"},{displayName:"Read all certificate data",emitValue:"read"},{displayName:"Write certificate data",emitValue:"write"},{displayName:"Manage user information",emitValue:"manage_users"}]}},methods:{showModal:function(){console.log("showingUserCreate");var e=document.getElementById("UserCreate");e.showModal()},hideModal:function(){console.log("hidingUserCreate");var e=document.getElementById("UserCreate");e.close()},generateKey:async function(){const e={roles:this.selectedPerms,username:this.username};var t=await this.$refs.ApiConnect.send_post("/user/create/",e,{},!1);void 0!=t&&"errors"in t&&t["errors"].length>0&&(this.changeStatus=t["errors"][0]),void 0!=t&&"result"in t?(this.password=t["result"]["password"],this.changeStatus="This value will only be shown once."):this.changeStatus="Error creating key"},copyValue:function(){navigator.clipboard.writeText(this.password).then(()=>{this.changeStatus="Copied!"}).catch(e=>{this.changeStatus="Copy failed.",console.error(e)})}}};const Js=(0,v.A)(Gs,[["render",Bs],["__scopeId","data-v-2d589b97"]]);var Qs=Js,Hs={name:"ManageUsers",components:{ApiConnect:w,PasswordModal:ws,UserCreate:Qs,DropDownCheckbox:hs,DeleteUser:qs},data(){return{RoleDescription:{"*":"All functionality (inherits everything)",read:"Read all certificate data",write:"Write all certificate data",manage_users:"Create, delete and change password for a user"},allProfiles:[],permissionsOpts:[{displayName:"Inherit all permissions",emitValue:"*"},{displayName:"Read all certificate data",emitValue:"read"},{displayName:"Write certificate data",emitValue:"write"},{displayName:"Manage user information",emitValue:"manage_users"}]}},methods:{notification(e){_.emit("notificationContent",e)},showPassword(){this.$refs.PasswordModal.showModal()},unix_to_ts(e){const t=new Date(1e3*e);return t.toLocaleString()},returnPayload:function(){let e={};for(var t in this.subjectData)console.log(t,this.subjectData[t]),void 0!=this.subjectData[t]&&""!=this.subjectData[t]&&(e[t]=this.subjectData[t]);return e},async get_user_details(){var e=await this.$refs.ApiConnect.send_get("/user/details/list/",{},!0);void 0!=e&&"result"in e&&"users"in e["result"]&&(this.allProfiles=e["result"]["users"]),console.log(this.allProfiles)},update_roles:async function(e,t){console.log("selected:",e);const s={roles:e};var n=await this.$refs.ApiConnect.send_post(`/user/profile/${t}/update/`,s,{},!1);console.log("typeof response:",typeof n),n&&n.errors&&0==n.errors.length&&this.notification({type:"success",content:`Updated role for ${t}`}),this.get_user_details()}},mounted(){this.get_user_details()}};const Ys=(0,v.A)(Hs,[["render",js],["__scopeId","data-v-5e3e9fc5"]]);var Zs=Ys;const en={style:{"margin-left":"15px"}},tn=["src"],sn=["src"],nn={ref:"logContainer",class:"holder",style:{height:"64vh","margin-right":"10px",overflow:"scroll"}},an={style:{"white-space":"pre",color:"rgb(55, 55, 55)"}};function on(e,t,s,n,o,l){const r=(0,a.g2)("SetSyslog"),c=(0,a.g2)("ApiConnect");return(0,a.uX)(),(0,a.CE)(a.FK,null,[(0,a.bF)(r,{ref:"SetSyslog"},null,512),(0,a.Lk)("div",en,[t[4]||(t[4]=(0,a.Lk)("h3",null,"System Logs",-1)),(0,a.Lk)("button",{onClick:t[0]||(t[0]=e=>{l.toggle_stream(),this.notification("success","Changed stream mode")}),class:"glass-button",style:{"margin-left":"0px","margin-top":"10px"}},[(0,a.Lk)("img",{class:"icon",src:this.streamMode?"/icons/stop.png":"/icons/play.png"},null,8,tn),(0,a.eW)("Â  "+(0,i.v_)(this.streamMode?"Stop stream":"Streaming mode"),1)]),(0,a.Lk)("button",{onClick:t[1]||(t[1]=e=>this.autoScroll=!this.autoScroll),class:"glass-button",style:{"margin-left":"0px","margin-top":"10px"}},[(0,a.Lk)("img",{class:"icon",src:this.autoScroll?"/icons/stop.png":"/icons/pause.png"},null,8,sn),(0,a.eW)("Â  "+(0,i.v_)(this.streamMode?"Stop autoscroll":"Autoscroll"),1)]),(0,a.Lk)("button",{onClick:t[2]||(t[2]=t=>e.$refs.SetSyslog.showModal()),class:"glass-button",style:{"margin-left":"0px","margin-top":"10px"}},[...t[3]||(t[3]=[(0,a.Lk)("img",{class:"icon",src:"/icons/chat_room.png"},null,-1),(0,a.eW)("Â  Configure Syslog",-1)])]),(0,a.Lk)("div",nn,[(0,a.Lk)("pre",an,"                "+(0,i.v_)(this.logContent)+"\n            ",1)],512)]),(0,a.bF)(c,{ref:"ApiConnect"},null,512)],64)}const ln={id:"setSyslog",class:"modal"},rn={class:"holder"},cn={style:{"text-align":"center","margin-left":"auto","margin-right":"auto"}};function dn(e,t,s,o,l,r){const c=(0,a.g2)("LoadingIcon"),d=(0,a.g2)("ApiConnect");return(0,a.uX)(),(0,a.CE)(a.FK,null,[(0,a.Lk)("div",null,[(0,a.Lk)("dialog",ln,[this.freezeModal?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.CE)("button",{key:0,autofocus:"",class:"close-btn",onClick:t[0]||(t[0]=e=>r.hideModal())},"x")),t[8]||(t[8]=(0,a.Lk)("h2",null,"Setup Syslog",-1)),(0,a.Lk)("div",rn,[t[6]||(t[6]=(0,a.Lk)("p",{style:{"margin-left":"10px"}},[(0,a.eW)("Set syslog host and port. Syslog is sent on UDP."),(0,a.Lk)("br"),(0,a.eW)("A system restart will occur after making this change.")],-1)),t[7]||(t[7]=(0,a.Lk)("br",null,null,-1)),(0,a.Lk)("div",cn,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>this.host=e),type:"text",id:"host",name:"host",placeholder:"SYSLOG HOST",required:""},null,512),[[n.Jo,this.host]]),t[4]||(t[4]=(0,a.Lk)("br",null,null,-1)),(0,a.bo)((0,a.Lk)("input",{style:{"margin-top":"2px"},"onUpdate:modelValue":t[2]||(t[2]=e=>this.port=e),type:"text",id:"port",name:"port",placeholder:"SYSLOG PORT",required:""},null,512),[[n.Jo,this.port]]),t[5]||(t[5]=(0,a.Lk)("br",null,null,-1)),(0,a.Lk)("p",null,(0,i.v_)(this.changeStatus),1),this.freezeModal?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.CE)("button",{key:0,class:"glass-button",onClick:t[3]||(t[3]=e=>r.setSyslog())},(0,i.v_)(this.buttonText),1)),l.freezeModal?((0,a.uX)(),(0,a.Wv)(c,{key:1,style:{display:"inline-block"}})):(0,a.Q3)("",!0)])])])]),(0,a.bF)(d,{ref:"ApiConnect"},null,512)],64)}var un={name:"SetSyslog",components:{ApiConnect:w,LoadingIcon:j},data(){return{host:"",port:"",changeStatus:"",buttonText:"Save",completed:!1,freezeModal:!1}},methods:{sleep:function(e){return new Promise(t=>setTimeout(t,e))},showModal:function(){this.completed=!1,console.log("showing syslog");var e=document.getElementById("setSyslog");e.showModal()},hideModal:function(){console.log("hiding password");var e=document.getElementById("setSyslog");e.close()},setSyslog:async function(){this.completed&&this.hideModal(),this.changeStatus="Submitting change. Please wait.",this.freezeModal=!0;const e={host:this.host,port:this.port};var t=await this.$refs.ApiConnect.send_post("/system/logs/syslog/",e,{},!1);void 0!=t&&"errors"in t&&t["errors"].length>0&&(this.changeStatus=t["errors"][0]),void 0!=t&&"result"in t&&"syslog_config"in t["result"]?(console.log("Waiting for restart..."),await this.sleep(91e3),console.log("Done!"),this.freezeModal=!1,this.changeStatus="Set syslog config.",this.buttonText="Close",this.completed=!0):this.changeStatus="Error setting syslog status"}}};const pn=(0,v.A)(un,[["render",dn],["__scopeId","data-v-6605c60c"]]);var hn=pn,gn={name:"SystemLogs",components:{ApiConnect:w,SetSyslog:hn},data(){return{autoScroll:!0,streamMode:!1,logContent:"getting system logs...",streamInterval:null}},methods:{notification(e,t){_.emit("notificationContent",{type:e,content:t})},unix_to_ts(e){const t=new Date(1e3*e);return t.toLocaleString()},async get_system_logs_static(){var e=await this.$refs.ApiConnect.send_get("/system/logs/",{},!0);void 0!=e&&"result"in e&&"log"in e["result"]&&(this.logContent=e["result"]["log"])},async toggle_stream(){this.streamMode=!this.streamMode,this.streamMode?this.streamInterval=setInterval(()=>{this.get_system_logs_stream()},2e3):(this.streamInterval&&(clearInterval(this.streamInterval),this.streamInterval=null),this.get_system_logs_static())},async get_system_logs_stream(){var e=await this.$refs.ApiConnect.send_get("/system/logs/?stream=true",{},!0);void 0!=e&&"result"in e&&"log"in e["result"]&&(this.logContent=e["result"]["log"])}},mounted(){this.get_system_logs_static()},unmounted(){this.streamInterval&&(clearInterval(this.streamInterval),this.streamInterval=null)},watch:{logContent(){this.$nextTick(()=>{const e=this.$refs.logContainer;e&&this.autoScroll&&e.scrollTo({top:e.scrollHeight,behavior:"smooth"})})}}};const mn=(0,v.A)(gn,[["render",on],["__scopeId","data-v-9422233a"]]);var yn=mn,fn={name:"SettingsView",components:{AboutMe:As,ManageUsers:Zs,SystemLogs:yn},data(){return{selected_setting:"user_profile"}}};const kn=(0,v.A)(fn,[["render",qt],["__scopeId","data-v-7c74b66a"]]);var _n=kn;s(116);const bn={style:{width:"80vw",height:"80vh","margin-left":"auto","margin-right":"auto","margin-top":"30px"}},vn={class:"glass_container",style:{height:"100%",padding:"10px"}},Ln={class:"glass_container_divider",style:{width:"20vw",float:"left","text-align":"left",height:"calc(100% - 15px)"}},wn=["onClick"],Cn=["src"],xn={style:{"margin-bottom":"0px","margin-top":"0px","vertical-align":"middle","font-weight":"300","font-size":"1.2em",display:"inline-block"}},An={class:"glass_container_divider",style:{width:"59vw",float:"right","text-align":"left",height:"calc(100% - 15px)"}},Sn={class:"glass_container",style:{padding:"10px",margin:"10px",width:"calc(58vw - 30px)"}},Mn={class:"glass_container",style:{padding:"10px",margin:"10px",width:"calc(58vw - 30px)"}},Dn={style:{"font-size":"1.1em","font-weight":"700","margin-top":"4px"}},En={style:{"margin-left":"10px"}},In={style:{"font-family":"monospace"}},Pn={style:{"margin-bottom":"0px"}},jn={style:{"margin-top":"0px"}},Un={style:{"font-family":"monospace","margin-top":"1px","margin-bottom":"2px"}},$n={style:{"font-family":"monospace","margin-top":"1px","margin-bottom":"2px"}},Fn={style:{"font-family":"monospace","margin-top":"1px","margin-bottom":"2px"}};function Nn(e,t,s,o,l,r){const c=(0,a.g2)("ApiConnect");return(0,a.uX)(),(0,a.CE)(a.FK,null,[(0,a.Lk)("div",bn,[t[10]||(t[10]=(0,a.Lk)("h2",{style:{"text-align":"left"}},"API Documentation",-1)),(0,a.Lk)("div",vn,[(0,a.Lk)("div",Ln,[(0,a.Lk)("div",null,[(0,a.Lk)("button",{style:{"vertical-align":"middle",padding:"15px"},class:(0,i.C4)("api_overview"==l.selected_node?"glass-button-selected":"glass-button"),onClick:t[0]||(t[0]=e=>l.selected_node="api_overview")},[...t[1]||(t[1]=[(0,a.Lk)("img",{src:"/icons/help.png",style:{height:"20px",display:"inline-block","vertical-align":"middle","margin-top":"0px"}},null,-1),(0,a.Lk)("h4",{style:{"margin-bottom":"0px","margin-top":"0px","vertical-align":"middle","font-weight":"300","font-size":"1.2em",display:"inline-block"}}," Â  Help ",-1)])],2),t[2]||(t[2]=(0,a.Lk)("br",null,null,-1))]),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(this.API_DATA,e=>((0,a.uX)(),(0,a.CE)("div",{key:e.category},[(0,a.Lk)("button",{style:{"vertical-align":"middle",padding:"15px"},class:(0,i.C4)(l.selected_node==e.category?"glass-button-selected":"glass-button"),onClick:t=>l.selected_node=e.category},[(0,a.Lk)("img",{src:e.icon,style:{height:"20px",display:"inline-block","vertical-align":"middle","margin-top":"0px"}},null,8,Cn),(0,a.Lk)("h4",xn," Â  "+(0,i.v_)(e.category),1)],10,wn),t[3]||(t[3]=(0,a.Lk)("br",null,null,-1))]))),128))]),(0,a.Lk)("div",An,[(0,a.Lk)("div",null,[(0,a.bo)((0,a.Lk)("div",Sn,[...t[4]||(t[4]=[(0,a.Fv)('<p style="font-size:1.3em;font-weight:700;margin-top:4px;" data-v-0d3180c3>Help</p><b data-v-0d3180c3>- API Endpoint -</b><p data-v-0d3180c3>The API Endpoint is available at <span style="font-family:monospace;font-weight:600;" data-v-0d3180c3> /api/ </span>of this HTTP server. Ensure that all requests end in a trialing forward slash (/) otherwise you may receive HTTP 404 responses. </p><br data-v-0d3180c3><b data-v-0d3180c3>- Authentication -</b><p data-v-0d3180c3>Use the documentation on this page to determine if your API request requires authentication when being accessed. This is common for most API endpoints. API Keys can be set up by selecting &#39;Settings&#39; and creating a new API key. <br data-v-0d3180c3><br data-v-0d3180c3> API authentication should be passed in the <span style="font-family:monospace;font-weight:600;" data-v-0d3180c3> authorization </span> header of the request. The value of this should be set to <span style="font-family:monospace;font-weight:600;" data-v-0d3180c3>Bearer api_key </span>.</p><br data-v-0d3180c3><b data-v-0d3180c3>- Role Based Access -</b><p data-v-0d3180c3>Certain API calls require a minimum permission to function. This is documented for each API call. When creating your API key, permissions are assigned at creation. It is important to determine what role are required before making a key, as roles cannot be changed after key creation.<br data-v-0d3180c3><br data-v-0d3180c3> It is best-practice to set the minimum permission. For example, a key that is only needed to manage users should only have the <span style="font-family:monospace;font-weight:600;" data-v-0d3180c3>manage_users</span> permission set.</p>',9)])],512),[[n.aG,"api_overview"==l.selected_node]]),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(this.API_DATA.find(e=>e.category==this.selected_node)?.endpoints||[],e=>((0,a.uX)(),(0,a.CE)("div",{key:e},[(0,a.Lk)("div",Mn,[(0,a.Lk)("p",Dn,(0,i.v_)(`/api${e.path}`),1),(0,a.Lk)("div",En,[(0,a.Lk)("p",In,(0,i.v_)(e["description"]),1),(0,a.Lk)("p",Pn,[t[5]||(t[5]=(0,a.Lk)("b",null,"Methods:",-1)),(0,a.eW)(" "+(0,i.v_)(e.method),1)]),(0,a.Lk)("p",jn,[t[6]||(t[6]=(0,a.Lk)("b",null,"Authentication:",-1)),(0,a.eW)(" "+(0,i.v_)(e.auth),1)]),(0,a.Lk)("p",Un,[t[7]||(t[7]=(0,a.Lk)("b",null,"Limited to roles:",-1)),(0,a.eW)(" "+(0,i.v_)(e["roles"]),1)]),(0,a.Lk)("p",$n,[t[8]||(t[8]=(0,a.Lk)("b",null,"Required in payload",-1)),(0,a.eW)(" "+(0,i.v_)(e["required_json"]),1)]),(0,a.Lk)("p",Fn,[t[9]||(t[9]=(0,a.Lk)("b",null,"Optional fields",-1)),(0,a.eW)(" "+(0,i.v_)(e["optional_json"]),1)])])])]))),128))])])])]),(0,a.bF)(c,{ref:"ApiConnect"},null,512)],64)}var Vn={name:"ApiDocs",components:{ApiConnect:w},data(){return{selected_node:null,API_DATA:[{category:"Certificate Authorities",icon:"/icons/flow_diagram.png",endpoints:[{path:"/create/certauthority/",method:"POST",auth:"auth_required",roles:["*","write"],description:"Creates a new CA, generating a private key and a self-signed certificate. Used as the root for issuing other certificates.",required_json:["name","keyphrase"],optional_json:["ca_days_length","common_name","country","state","city","organization","email"]},{path:"/delete/certauthority/<ca_id>/",method:"GET",auth:"auth_required",roles:["*","write"],description:"Deletes the specified Certificate Authority.",required_json:[],optional_json:[]},{path:"/list/certauthority/",method:"GET",auth:"auth_required",roles:["*","read"],description:"Lists all available Certificate Authorities.",required_json:[],optional_json:[]},{path:"/download/certauthority/<ca_id>/",method:"GET",auth:"auth_required",roles:["*","read","write"],description:"Downloads the CA's .pem file. Use buffer=true for raw binary format instead of JSON.",required_json:[],optional_json:[]}]},{category:"Certificates",icon:"/icons/certificate.png",endpoints:[{path:"/create/certificate/<ca_id>/",method:"POST",auth:"auth_required",roles:["*","write"],description:"Creates a new client/server certificate signed by the specified Certificate Authority.",required_json:["name","keyphrase","ca_name"],optional_json:["cert_days_length","common_name","country","state","city","organization","email"]},{path:"/delete/certificate/<ca_id>/<cert_name>/",method:"GET",auth:"auth_required",roles:["*","write"],description:"Deletes a specific certificate by name. Must specify the parent authority ID.",required_json:[],optional_json:[]},{path:"/list/certificates/",method:"GET",auth:"auth_required",roles:["*","read"],description:"Lists all individual certificates.",required_json:[],optional_json:[]},{path:"/download/certificate/<ca_id>/<cert_name>/",method:"GET",auth:"auth_required",roles:["*","read","write"],description:"Downloads the .crt and .key files. Use buffer=true for .zip binary file",required_json:[],optional_json:[]}]},{category:"User and Authentication",icon:"/icons/user.png",endpoints:[{path:"/user/login/",method:"POST",auth:"None (Unauthenticated)",description:"Authenticates a user using credentials. Returns a token in response which should be used for further requests.",required_json:["username","password"],optional_json:[]},{path:"/user/resetpassword/<for_user>/",method:"POST",auth:"auth_required",roles:["*","manage_users"],description:"Allows a user to change their password. 'password' value is for the actors password.",required_json:["password","new_password"],optional_json:[]},{path:"/user/details/me/",method:"GET",auth:"auth_required",roles:[],description:"Get details for the authenticated user token.",required_json:[],optional_json:[]},{path:"/user/details/list/",method:"GET",auth:"auth_required",roles:["*","manage_users"],description:"Lists all users.",required_json:[],optional_json:[]},{path:"/user/create/",method:"POST",auth:"auth_required + Role: * or manage_users",roles:["*","manage_users"],description:"Creates a new user account. Password is generated in response.",required_json:["username","roles"],optional_json:[""]},{path:"/user/profile/<for_user>/update/",method:"POST",auth:"auth_required + Role: * or manage_users",roles:["*","manage_users"],description:"Updates user roles or other profile elements. Note role assignment scope is limited to that of the authenticated user.",required_json:[],optional_json:["roles"]},{path:"/user/profile/<for_user>/delete/",method:"POST",auth:"auth_required + Role: * or manage_users",roles:["*","manage_users"],description:"Deletes a user account. Cannot delete self.",required_json:[],optional_json:[]}]},{category:"API Keys",icon:"/icons/our_process.png",endpoints:[{path:"/user/apikeys/create/",method:"POST",auth:"auth_required",roles:[],description:"Generates a new API key for API access, which can have specific roles and expiry. Note role assignment scope is limited to that of the authenticated user.",required_json:["roles","days_expiry"],optional_json:[]},{path:"/user/apikeys/list/",method:"GET",auth:"auth_required",roles:[],description:"Lists API keys belonging to the current user.",required_json:[],optional_json:[]},{path:"/user/apikeys/delete/<keyid>/",method:"GET",auth:"auth_required",roles:[],description:"Deletes a specific API key. Only the owner can delete keys",required_json:[],optional_json:[]}]},{category:"System",icon:"/icons/system.png",endpoints:[{path:"/system/logs/",method:"GET",auth:"auth_required",description:"Retrieves 'audit.log' content.",roles:[],required_json:[],optional_json:["URL param: stream=true for live feed"]},{path:"/system/logs/syslog/",method:"POST",auth:"auth_required",roles:["*","system_admin"],description:"Configures remote syslog forwarding. **Triggers API restart.**",required_json:["host","port"],optional_json:[]},{path:"/",method:"GET/POST",auth:"None (Unauthenticated)",roles:[],description:"Health check endpoint (ping/pong).",required_json:[],optional_json:[]}]}]}},methods:{unix_to_ts(e){const t=new Date(1e3*e);return t.toLocaleString()}},async mounted(){this.selected_node="api_overview"}};const Tn=(0,v.A)(Vn,[["render",Nn],["__scopeId","data-v-0d3180c3"]]);var Wn=Tn;const On=[{path:"/",name:"home",component:Re},{path:"/login",name:"login",meta:{hideNavbar:!0},component:ne},{path:"/tree",name:"tree",component:ct},{path:"/createcert",name:"createcert",component:Nt},{path:"/settings",name:"settings",component:_n},{path:"/apidocs",name:"apidocs",component:Wn}],qn=(0,G.aE)({history:(0,G.LA)("/"),routes:On});var Kn=qn;(0,n.Ef)(B).use(Kn).mount("#app")}},t={};function s(n){var a=t[n];if(void 0!==a)return a.exports;var i=t[n]={exports:{}};return e[n].call(i.exports,i,i.exports,s),i.exports}s.m=e,function(){var e=[];s.O=function(t,n,a,i){if(!n){var o=1/0;for(d=0;d<e.length;d++){n=e[d][0],a=e[d][1],i=e[d][2];for(var l=!0,r=0;r<n.length;r++)(!1&i||o>=i)&&Object.keys(s.O).every(function(e){return s.O[e](n[r])})?n.splice(r--,1):(l=!1,i<o&&(o=i));if(l){e.splice(d--,1);var c=a();void 0!==c&&(t=c)}}return t}i=i||0;for(var d=e.length;d>0&&e[d-1][2]>i;d--)e[d]=e[d-1];e[d]=[n,a,i]}}(),function(){s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,{a:t}),t}}(),function(){s.d=function(e,t){for(var n in t)s.o(t,n)&&!s.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}}(),function(){s.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={524:0};s.O.j=function(t){return 0===e[t]};var t=function(t,n){var a,i,o=n[0],l=n[1],r=n[2],c=0;if(o.some(function(t){return 0!==e[t]})){for(a in l)s.o(l,a)&&(s.m[a]=l[a]);if(r)var d=r(s)}for(t&&t(n);c<o.length;c++)i=o[c],s.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return s.O(d)},n=self["webpackChunkcertmanager_ui"]=self["webpackChunkcertmanager_ui"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var n=s.O(void 0,[504],function(){return s(9267)});n=s.O(n)})();
//# sourceMappingURL=app.5af8fe03.js.map